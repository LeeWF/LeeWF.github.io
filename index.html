<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="愤怒的IT青年">
<meta property="og:url" content="http://www.yoursite.com/index.html">
<meta property="og:site_name" content="愤怒的IT青年">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="愤怒的IT青年">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.yoursite.com/"/>





  <title>愤怒的IT青年</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">愤怒的IT青年</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>
<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



<div class="custom-site-signature" >将来的你，一定会感谢此刻的自己…… </div>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/Docker/2018/08/cjl6f9v6i000csoq6smqiiv4o.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Docker/2018/08/cjl6f9v6i000csoq6smqiiv4o.html" itemprop="url">Docker 安装和操作笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-23T17:50:51+08:00">
                2018-08-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index">
                    <span itemprop="name">Docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Docker配置"><a href="#Docker配置" class="headerlink" title="Docker配置"></a>Docker配置</h2><p><strong>查看Linux版本号</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br><span class="line">结果：</span><br><span class="line">LSB Version:    :core-4.1-amd64:core-4.1-noarch</span><br><span class="line">Distributor ID: CentOS</span><br><span class="line">Description:    CentOS Linux release 7.4.1708 (Core)</span><br><span class="line">Release:        7.4.1708</span><br><span class="line">Codename:       Core</span><br></pre></td></tr></table></figure></p>
<h3 id="docker-安装"><a href="#docker-安装" class="headerlink" title="docker 安装"></a>docker 安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker</span><br></pre></td></tr></table></figure>
<h3 id="docker-启动前的注意事项"><a href="#docker-启动前的注意事项" class="headerlink" title="docker 启动前的注意事项"></a>docker 启动前的注意事项</h3><p>####　更新文件系统<br><code>因为用的overlay2文件系统，而系统默认只能识别overlay文件系统</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#systemctl stop docker      //停掉docker服务</span><br><span class="line">#rm -rf /var/lib/docker     //注意会清掉docker images的镜像  </span><br><span class="line">//如果已经启动docker，请执行上述操作</span><br><span class="line">#vi /etc/sysconfig/docker-storage       //将文件里的overlay2改成overlay即可 </span><br><span class="line">//例：DOCKER_STORAGE_OPTIONS=&quot;--storage-driver overlay &quot;</span><br></pre></td></tr></table></figure>
<h4 id="修改selinux相关"><a href="#修改selinux相关" class="headerlink" title="修改selinux相关"></a>修改selinux相关</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#vi /etc/sysconfig/docker         //去掉option后面的--selinux-enabled</span><br></pre></td></tr></table></figure>
<h3 id="启动docker-后台服务"><a href="#启动docker-后台服务" class="headerlink" title="启动docker 后台服务"></a>启动docker 后台服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start</span><br></pre></td></tr></table></figure>
<h3 id="docker-版本号"><a href="#docker-版本号" class="headerlink" title="docker 版本号"></a>docker 版本号</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure>
<h3 id="使用阿里云加速Docker"><a href="#使用阿里云加速Docker" class="headerlink" title="使用阿里云加速Docker"></a>使用阿里云加速Docker</h3><p>Docker官方镜像网站部署在外网，因此我们国内下载比较慢。看了一下国内最好的Docker加速服务就是阿里云了。阿里云的其他镜像比如Maven镜像之类的也都不错。</p>
<p>首先需要注册一个<a href="https://www.aliyun.com/" target="_blank" rel="noopener">阿里云</a>的帐号，可能还需要其他一点信息。然后进入<a href="https://cr.console.aliyun.com/?spm=5176.100239.blogcont29941.12.ZHezpK" target="_blank" rel="noopener">容器Hub服务控制台</a>，中间有一个加速器。我们点击它之后，阿里云会为我们创建一个专属加速器地址。</p>
<p>然后需要检查Docker客户端的版本，如果小于1.10，只能按照自己系统版本寻找相应的办法了。如果大于等于1.10，就可以直接使用下面的配置方法。配置方法很简单，在<code>/etc/docker/daemon.json</code>中添加一段配置。如果没有该文件则创建。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://aukdryjg.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后重启Docker服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure></p>
<h2 id="Docker-常用命令"><a href="#Docker-常用命令" class="headerlink" title="Docker 常用命令"></a>Docker 常用命令</h2><ul>
<li>容器生命周期管理 — <code>docker [run|start|stop|restart|kill|rm|pause|unpause]</code></li>
<li>容器操作运维 — <code>docker [ps|inspect|top|attach|events|logs|wait|export|port]</code></li>
<li>容器rootfs命令 — <code>docker [commit|cp|diff]</code></li>
<li>镜像仓库 — <code>docker [login|pull|push|search]</code></li>
<li>本地镜像管理 — <code>docker [images|rmi|tag|build|history|save|import]</code></li>
<li>其他命令 — <code>docker [info|version]</code></li>
</ul>
<h3 id="Docker管理"><a href="#Docker管理" class="headerlink" title="Docker管理"></a>Docker管理</h3><h4 id="启动Docker"><a href="#启动Docker" class="headerlink" title="启动Docker"></a>启动Docker</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
<h5 id="Docker-开机自启动"><a href="#Docker-开机自启动" class="headerlink" title="Docker 开机自启动"></a>Docker 开机自启动</h5><p><strong>设置开机自启动</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure></p>
<p><del>成功后显示</del><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.</span><br></pre></td></tr></table></figure></p>
<p><strong>重启电脑</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown -r now</span><br></pre></td></tr></table></figure></p>
<p><strong>查看Docker启动状态</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status docker</span><br></pre></td></tr></table></figure></p>
<h3 id="image管理"><a href="#image管理" class="headerlink" title="image管理"></a>image管理</h3><h4 id="查找image-search"><a href="#查找image-search" class="headerlink" title="查找image(search)"></a>查找image(search)</h4><ul>
<li><p>从 <a href="https://hub.docker.com/" target="_blank" rel="noopener"><strong>Docker Hub</strong></a> 网站来搜索镜像</p>
</li>
<li><p>使用 docker search 命令来搜索镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search httpd</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="拉取image-pull"><a href="#拉取image-pull" class="headerlink" title="拉取image(pull)"></a>拉取image(pull)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//tag			--版本号默认为最新(latest)</span><br><span class="line">docker pull mysql:tag</span><br></pre></td></tr></table></figure>
<h4 id="运行image-run"><a href="#运行image-run" class="headerlink" title="运行image(run)"></a>运行image(run)</h4><p><strong>如果没有pull，会自动pull然后再run</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">--name=mysql					--这个属性是为启动的MySQL容器设置一个别名</span><br><span class="line">-d								--以守护进程方式运行 (后台运行)</span><br><span class="line">-e MYSQL_ROOT_PASSWORD			--在启动MySQL的时候设置密码,这里密码以123456演示</span><br><span class="line">-p 33060:3306					--物理机端口映射容器端口(物理机：容器)</span><br><span class="line">-v /app/mysql/:/var/lib/mysql 	--通过Volume把容器内的文件映射到物理机(物理机：容器)</span><br><span class="line">--privileged=true				--Selinux开启时，给容器添加特定权限</span><br><span class="line">*/ </span><br><span class="line">docker run --name=mysql  --privileged=true -e MYSQL_ROOT_PASSWORD=123456 -p 33060:3306 -v /app/mysql:/var/lib/mysql -d mysql:5.7</span><br></pre></td></tr></table></figure></p>
<h4 id="创建image"><a href="#创建image" class="headerlink" title="创建image"></a>创建image</h4><p>从镜像仓库下载的，都是别人事先做好的，如果需要自己一个定制的镜像，有2种方式：</p>
<ul>
<li>基于一个现有的镜像来修改</li>
<li>基于本地模板导入</li>
<li>基于dockerfile来创建</li>
</ul>
<h5 id="image修改"><a href="#image修改" class="headerlink" title="image修改"></a>image修改</h5><p>先运行一个现有的image，然后在运行的container中进行操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -i ubuntu:15.10 /bin/bash  </span><br><span class="line">root@e218edb10161:/# apt-get update  </span><br><span class="line">root@e218edb10161:/# apt-get install wget  </span><br><span class="line">root@e218edb10161:/# exit</span><br></pre></td></tr></table></figure></p>
<p>需要对该镜像进行提交操作，即做一个保存操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">-m				--提交的描述信息</span><br><span class="line">-a				--指定镜像作者</span><br><span class="line">9255435d13b0	--容器ID，通过docker ps来查看</span><br><span class="line">lee_ubuntu		--指定要创建的目标镜像名</span><br><span class="line">*/</span><br><span class="line">docker commit -m=&quot;with wget&quot; -a=&quot;lee&quot; 9255435d13b0 lee_ubuntu</span><br><span class="line">完成：</span><br><span class="line">sha256:6d7c6c08c8caf2ae999e4431ef46f5ed3bf5e51a23c88833d4ea98f8b4b78d37</span><br></pre></td></tr></table></figure></p>
<p>查看image是否保存<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">结果：</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">lee_ubuntu          latest              6d7c6c08c8ca        9 minutes ago       137MB</span><br><span class="line">ubuntu              15.10               9b9cb95443b5        20 months ago       137MB</span><br><span class="line">……</span><br></pre></td></tr></table></figure></p>
<h5 id="基于本地模板导入"><a href="#基于本地模板导入" class="headerlink" title="基于本地模板导入"></a><del>基于本地模板导入</del></h5><p>可以从操作系统模板文件导入一个镜像，比如使用OpenVZ提供的模板创建，OPENVZ下载模板在<a href="http://openvz.org/Download/template/precreated" target="_blank" rel="noopener">http://openvz.org/Download/template/precreated</a><br>下载image<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>导入image<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo cat ubuntu–14.04–x86_64–minimal.tar.gz | docker import – ubuntu:14.04</span><br><span class="line">成功的话，就会返回根据模板建立的镜像的长ID</span><br><span class="line">ab80404d13d580965b9919b640169ccb585ea7884e6aa9de1ec043075c65fe35</span><br></pre></td></tr></table></figure></p>
<p>最后查看本地image<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">结果：</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</span><br><span class="line">ubuntu              14.04               ab80404d13d5        56 seconds ago      215.4 MB</span><br><span class="line">….</span><br></pre></td></tr></table></figure></p>
<h5 id="通过dockerfile创建"><a href="#通过dockerfile创建" class="headerlink" title="通过dockerfile创建"></a>通过dockerfile创建</h5><p>dockerfile与shell脚本类似，文件格式如下：<br><code>路径：/path/to/dockerfile</code><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 基于centos6.7 版本构建的(所有的docker镜像都是基于一个linux系统的，因为首先它得具备一个完整的运行生态)</span><br><span class="line">FROM    centos:6.7  </span><br><span class="line"><span class="meta">#</span> 维护者：Macy    邮箱：five3@163.com</span><br><span class="line">MAINTAINER      Macy "five3@163.com"  </span><br><span class="line"><span class="meta">#</span> 修改root密码</span><br><span class="line">RUN     /bin/echo 'root:123456' |chpasswd  </span><br><span class="line"><span class="meta">#</span> 添加一个five3用户</span><br><span class="line">RUN     useradd five3 </span><br><span class="line">RUN     /bin/echo 'five3:123456' |chpasswd  </span><br><span class="line"><span class="meta">#</span> 设置系统的默认编码为utf-8</span><br><span class="line">RUN     /bin/echo -e "LANG=\"en_US.UTF-8\"" &gt;/etc/default/local  </span><br><span class="line"><span class="meta">#</span> 通过EXPOSE命令对外开发了22和80端口。即ssh端口与WEB端口</span><br><span class="line">EXPOSE  22  </span><br><span class="line">EXPOSE  80  </span><br><span class="line"><span class="meta">#</span> CMD命令用于设置镜像运行后的启动命令。这里是默认会启动ssh服务，这样当镜像运行之后我们就可以通过ssh连接该容器了</span><br><span class="line">CMD     /usr/sbin/sshd -D</span><br></pre></td></tr></table></figure></p>
<p>dockerfile完成之后，就可以build自定义的镜像了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//-t           --指定要创建的目标镜像名,注意名称只能是小写字母</span><br><span class="line">docker build -t five3/centos:6.7 /path/to/dockerfile</span><br></pre></td></tr></table></figure></p>
<h4 id="查看image列表"><a href="#查看image列表" class="headerlink" title="查看image列表"></a>查看image列表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<h4 id="删除image-rmi"><a href="#删除image-rmi" class="headerlink" title="删除image(rmi)"></a>删除image(rmi)</h4><p><code>docker rmi &lt;image_id/image_name ...&gt;</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker rmi 319ad99be331</span><br><span class="line"></span><br><span class="line">如果存在container时不能rmi，要先删除由这个镜像启动的容器</span><br><span class="line">Error response from daemon: conflict: unable to remove repository reference &quot;hello-world&quot; (must force) - container 319ad99be331 is using its referenced image f2a91732366c</span><br></pre></td></tr></table></figure></p>
<h4 id="存出image"><a href="#存出image" class="headerlink" title="存出image"></a>存出image</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">结果：</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">lee_ubuntu          latest              6d7c6c08c8ca        9 minutes ago       137MB</span><br><span class="line">ubuntu              15.10               9b9cb95443b5        20 months ago       137MB</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>如果想要把镜像存出到本地文件，可以使用docker save命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker save -o /data/lee_ubuntu.tar lee_ubuntu:latest</span><br><span class="line">查看结果：</span><br><span class="line">[root@localhost ~]# cd /data</span><br><span class="line">[root@localhost data]# ls</span><br><span class="line">lee_ubuntu.tar</span><br></pre></td></tr></table></figure></p>
<h4 id="载入image"><a href="#载入image" class="headerlink" title="载入image"></a>载入image</h4><p>删除已存在image<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker rmi lee_ubuntu</span><br><span class="line">输出结果：</span><br><span class="line">Untagged: lee_ubuntu:latest</span><br><span class="line">Deleted: sha256:6d7c6c08c8caf2ae999e4431ef46f5ed3bf5e51a23c88833d4ea98f8b4b78d37</span><br><span class="line">Deleted: sha256:22f8433a49329b664aca749ab499e324d187ea553146abb5b1b652fb8941d379</span><br></pre></td></tr></table></figure></p>
<p>载入image<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//可以简化为：docker load &lt; testimage.tar</span><br><span class="line">docker load --input /data/lee_ubuntu.tar</span><br><span class="line">结果：</span><br><span class="line">684ffe05c4cd: Loading layer  5.632kB/5.632kB</span><br><span class="line">Loaded image: lee_ubuntu:latest</span><br></pre></td></tr></table></figure></p>
<p>查看image列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">lee_ubuntu          latest              6d7c6c08c8ca        25 minutes ago      137MB</span><br><span class="line">ubuntu              15.10               9b9cb95443b5        20 months ago       137MB</span><br></pre></td></tr></table></figure></p>
<h3 id="container管理"><a href="#container管理" class="headerlink" title="container管理"></a>container管理</h3><h4 id="查看container"><a href="#查看container" class="headerlink" title="查看container"></a>查看container</h4><p><strong>运行中的container</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure></p>
<p><strong>所有container(包括未运行)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure></p>
<h4 id="开启-停止-重启container（start-stop-restart）"><a href="#开启-停止-重启container（start-stop-restart）" class="headerlink" title="开启/停止/重启container（start/stop/restart）"></a>开启/停止/重启container（start/stop/restart）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker restart mysql</span><br><span class="line">$ docker stop mysql</span><br><span class="line">$ docker start mysql</span><br></pre></td></tr></table></figure>
<h4 id="删除一个或多个container（rm）"><a href="#删除一个或多个container（rm）" class="headerlink" title="删除一个或多个container（rm）"></a>删除一个或多个container（rm）</h4><p><code>docker rm &lt;container_id/contaner_name&gt;</code><br><strong>删除<code>NAME</code>为<code>mysql</code>的容器</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f mysql</span><br></pre></td></tr></table></figure></p>
<p><strong>删除所有停止的容器</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm $(docker ps -a -q)</span><br></pre></td></tr></table></figure></p>
<h4 id="进入container"><a href="#进入container" class="headerlink" title="进入container"></a>进入container</h4><p><code>进入&#39;rmqnamesrv&#39;容器</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it rmqnamesrv /bin/bash</span><br></pre></td></tr></table></figure></p>
<h5 id="container内安装vim"><a href="#container内安装vim" class="headerlink" title="container内安装vim"></a>container内安装vim</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line"></span><br><span class="line">apt-get install -y vim</span><br></pre></td></tr></table></figure>
<h2 id="Docker-神操作"><a href="#Docker-神操作" class="headerlink" title="Docker 神操作"></a>Docker 神操作</h2><h3 id="修改docker容器端口映射的方法-调试失败，容器已爆炸"><a href="#修改docker容器端口映射的方法-调试失败，容器已爆炸" class="headerlink" title="修改docker容器端口映射的方法(调试失败，容器已爆炸)"></a>修改docker容器端口映射的方法(调试失败，容器已爆炸)</h3><pre><code>docker run可以指定端口映射，但是容器一旦生成，就没有一个命令可以直接修改。通常间接的办法是，保存镜像，再创建一个新的容器，在创建时指定新的端口映射
</code></pre><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># docker ps</span><br><span class="line">CONTAINER ID        IMAGE                          COMMAND                  CREATED             STATUS                PORTS                                                                  NAMES</span><br><span class="line">30dd09dcdf1b        gitlab/gitlab-ce:latest        &quot;/assets/wrapper&quot;        13 days ago         Up 5 days (healthy)   0.0.0.0:33-&gt;33/tcp, 0.0.0.0:80-&gt;80/tcp, 22/tcp, 0.0.0.0:443-&gt;443/tcp   gitlab</span><br></pre></td></tr></table></figure>
<p>例如：已经将物理机80端口映射到容器80端口</p>
<h5 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">`# docker stop gitlab</span><br><span class="line">gitlab</span><br></pre></td></tr></table></figure>
<h5 id="停止docker服务"><a href="#停止docker服务" class="headerlink" title="停止docker服务"></a>停止docker服务</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>
<h5 id="修改这个容器的hostconfig-json文件中的端口"><a href="#修改这个容器的hostconfig-json文件中的端口" class="headerlink" title="修改这个容器的hostconfig.json文件中的端口"></a>修改这个容器的hostconfig.json文件中的端口</h5><p>路径：<code>/var/lib/docker/containers/[hash_of_the_container]/hostconfig.json</code><br><code>注意：如果config.v2.json里面也记录了端口，也要修改</code></p>
<p>修改：<code>[&quot;HostPort&quot;:&quot;80&quot;]</code>改为<code>[&quot;HostPort&quot;:&quot;8000&quot;]</code></p>
<p>查看<code>[hash_of_the_container]</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect &lt;container_name&gt;     # “Id”字段的值是哈希值[hash_of_the_container]</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">例：</span><br><span class="line"># docker inspect gitlab</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;30dd09dcdf1b90092feb440d728e3d5b26e0938fa0bdb643b8dc6d223a0d4254&quot;                                                                                             ,</span><br><span class="line">        &quot;Created&quot;: &quot;2018-03-31T03:41:01.177423852Z&quot;,</span><br><span class="line">        #省略……</span><br></pre></td></tr></table></figure>
<p><strong>相关链接</strong></p>
<p><a href="http://www.docker.org.cn/book/docker/run-saved-image-11.html" target="_blank" rel="noopener">docker中文手册</a><br><a href="http://www.runoob.com/docker/docker-image-usage.html" target="_blank" rel="noopener">runoob-docker教程</a><br><a href="http://www.runoob.com/docker/centos-docker-install.html" target="_blank" rel="noopener">CentOS Docker 安装</a><br><a href="https://blog.csdn.net/permike/article/details/51879578" target="_blank" rel="noopener">docker常用命令详解</a><br><a href="https://devtor.cn/operation/docker-mysql.html" target="_blank" rel="noopener">ZengGUI 博客 – Docker部署</a><br><a href="https://blog.csdn.net/qq_32447321/article/details/60132256" target="_blank" rel="noopener">centos7安装docker并设置开机启动</a><br><a href="https://www.cnblogs.com/zhangmingcheng/p/5720792.html" target="_blank" rel="noopener">Docker镜像的创建、存出、载入</a><br><a href="https://blog.csdn.net/shiqiangdexin/article/details/52472195" target="_blank" rel="noopener">怎样用docker创建我们自己的镜像</a><br><a href="https://blog.csdn.net/five3/article/details/75669884" target="_blank" rel="noopener">docker镜像创建与基本使用</a><br><a href="https://blog.csdn.net/wesleyflagon/article/details/78961990" target="_blank" rel="noopener">修改docker容器端口映射的方法</a><br><a href="https://stackoverflow.com/questions/19335444/how-do-i-assign-a-port-mapping-to-an-existing-docker-container" target="_blank" rel="noopener">How do I assign a port mapping to an existing Docker container?</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/SpringCould/2018/03/spring-could.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/SpringCould/2018/03/spring-could.html" itemprop="url">Spring Could 入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-28T22:11:31+08:00">
                2018-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SpringCould/" itemprop="url" rel="index">
                    <span itemprop="name">SpringCould</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h2><h3 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h3><p>微服务架构就是将一个完整的应用从数据存储开始垂直拆分成多个不同的服务，每个服务都能独立部署、独立维护、独立扩展，服务与服务间通过诸如RESTful API的方式互相调用。<br>更多详情可以阅读始祖Martin Fowler的<a href="http://martinfowler.com/articles/microservices.html" target="_blank" rel="noopener">《Microservices》</a>，（中文翻译版<a href="https://mp.weixin.qq.com/s/fzk-kENu0I22P3F2Vu7KBA" target="_blank" rel="noopener">点击查看</a>）</p>
<h2 id="Spring-Cloud简介"><a href="#Spring-Cloud简介" class="headerlink" title="Spring Cloud简介"></a>Spring Cloud简介</h2><p>Spring Cloud是一个基于Spring Boot实现的云应用开发工具，它为<strong>基于JVM的云应用开发中的配置管理、服务发现、断路器、智能路由、微代理、控制总线、全局锁、决策竞选、分布式会话和集群状态管理等</strong>操作提供了一种简单的开发方式。</p>
<p><del>Spring Cloud包含了多个(暂时为17个，可能还会新增)子项目（针对分布式系统中涉及的多个不同开源产品），比如：Spring Cloud Config、Spring Cloud Netflix、Spring Cloud CloudFoundry、Spring Cloud AWS、Spring Cloud Security、Spring Cloud Commons、Spring Cloud Zookeeper、Spring Cloud CLI等项目。</del></p>
<h3 id="Spring-Cloud命名"><a href="#Spring-Cloud命名" class="headerlink" title="Spring Cloud命名"></a>Spring Cloud命名</h3><p><strong>Spring Cloud版本名字采用了伦敦地铁站的名字</strong>，根据字母表的顺序来对应版本时间顺序，比如：最早的Release版本：Angel，第二个Release版本：Brixton，以此类推……<br><em>Spring Cloud是一个拥有诸多子项目的大型综合项目，原则上其子项目也都维护着自己的发布版本号。那么每一个Spring Cloud的版本都会包含不同的子项目版本，为了要管理每个版本的子项目清单，避免版本名与子项目的发布号混淆，所以没有采用版本号的方式，而是通过命名的方式。</em></p>
<h4 id="版本号"><a href="#版本号" class="headerlink" title="版本号"></a>版本号</h4><p>SRX(service releases)版本：当一个版本的Spring Cloud项目的发布内容积累到临界点或者一个严重bug解决可用后，就会发布一个“service releases”版本，简称SRX版本，其中X是一个递增数字。<br>例如：Angel.SR6，Brixton.SR5中的SR6、SR5就是版本号了。</p>
<h3 id="Spring-Cloud组件架构图"><a href="#Spring-Cloud组件架构图" class="headerlink" title="Spring Cloud组件架构图"></a>Spring Cloud组件架构图</h3><p><img src="http://img0.ph.126.net/DTQKKWiG042oSwhlR19fjg==/6631598829818973591.jpg" alt="Spring-Cloud组件架构.jpg"></p>
<h3 id="spring-cloud和dubbo简单对比"><a href="#spring-cloud和dubbo简单对比" class="headerlink" title="spring cloud和dubbo简单对比"></a>spring cloud和dubbo简单对比</h3><p>Dubbo：是阿里巴巴服务化治理的核心框架，并被广泛应用于阿里巴巴集团的各成员站点。</p>
<h4 id="Spring-Cloud和Dubbo提供支持对比"><a href="#Spring-Cloud和Dubbo提供支持对比" class="headerlink" title="Spring Cloud和Dubbo提供支持对比"></a>Spring Cloud和Dubbo提供支持对比</h4><table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Dubbo</th>
<th style="text-align:center">Spring Cloud</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">服务注册中心</td>
<td style="text-align:center">Zookeeper</td>
<td style="text-align:center">Spring Cloud Netflix Eureka</td>
</tr>
<tr>
<td style="text-align:center">服务调用方式</td>
<td style="text-align:center">RPC</td>
<td style="text-align:center">REST API</td>
</tr>
<tr>
<td style="text-align:center">服务网关</td>
<td style="text-align:center">无</td>
<td style="text-align:center">Spring Cloud Netflix Zuul</td>
</tr>
<tr>
<td style="text-align:center">断路器</td>
<td style="text-align:center">不完善</td>
<td style="text-align:center">Spring Cloud Netflix Hystrix</td>
</tr>
<tr>
<td style="text-align:center">分布式配置</td>
<td style="text-align:center">无</td>
<td style="text-align:center">Spring Cloud Config</td>
</tr>
<tr>
<td style="text-align:center">服务跟踪</td>
<td style="text-align:center">无</td>
<td style="text-align:center">Spring Cloud Sleuth</td>
</tr>
<tr>
<td style="text-align:center">消息总线</td>
<td style="text-align:center">无</td>
<td style="text-align:center">Spring Cloud Bus</td>
</tr>
<tr>
<td style="text-align:center">数据流</td>
<td style="text-align:center">无</td>
<td style="text-align:center">Spring Cloud Stream</td>
</tr>
<tr>
<td style="text-align:center">批量任务</td>
<td style="text-align:center">无</td>
<td style="text-align:center">Spring Cloud Task</td>
</tr>
<tr>
<td style="text-align:center">……</td>
<td style="text-align:center">……</td>
<td style="text-align:center">……</td>
</tr>
</tbody>
</table>
<p>申明：Dubbo对于上表中总结为“无”的组件不代表不能实现，而只是Dubbo框架自身不提供，需要另外整合以实现对应的功能，比如：</p>
<ul>
<li>分布式配置：可以使用淘宝的diamond、百度的disconf来实现分布式配置管理。但是Spring Cloud中的Config组件除了提供配置管理之外，由于其存储可以使用git，因此它天然的实现了配置内容的版本管理，可以完美的与应用版本管理整合起来。</li>
<li>服务跟踪：可以使用京东开源的Hydra</li>
<li>批量任务：可以使用当当开源的Elastic-Job</li>
<li>……</li>
</ul>
<h2 id="Spring-Cloud功能介绍"><a href="#Spring-Cloud功能介绍" class="headerlink" title="Spring Cloud功能介绍"></a>Spring Cloud功能介绍</h2><h3 id="服务治理"><a href="#服务治理" class="headerlink" title="服务治理"></a>服务治理</h3><p>由于Spring Cloud为服务治理做了一层抽象接口，所以在Spring Cloud应用中可以支持多种不同的服务治理框架，比如：Netflix Eureka、Consul、Zookeeper。在Spring Cloud服务治理抽象层的作用下，我们可以无缝地切换服务治理实现，并且不影响任何其他的服务注册、服务发现、服务调用等逻辑。</p>
<h2 id="Spring-Cloud构建微服务架构"><a href="#Spring-Cloud构建微服务架构" class="headerlink" title="Spring Cloud构建微服务架构"></a>Spring Cloud构建微服务架构</h2><p><strong>参考连接：</strong><br><a href="https://springcloud.cc/" target="_blank" rel="noopener">中文网</a><br><a href="https://spring.io/projects" target="_blank" rel="noopener">英文官网</a><br><a href="https://springcloud.cc/spring-cloud-dalston.html" target="_blank" rel="noopener">官方文档</a><br><a href="https://github.com/dyc87112/SpringCloud-Learning" target="_blank" rel="noopener">GitHub</a><br><a href="http://git.oschina.net/didispace" target="_blank" rel="noopener">OsChina</a><br><a href="http://blog.didispace.com/categories/Spring-Cloud/" target="_blank" rel="noopener">翟永超–Spring Cloud系列博文</a><br><a href="https://blog.csdn.net/forezp/article/details/70148833" target="_blank" rel="noopener">方志朋–Spring Cloud系列教程</a><br><a href="https://blog.csdn.net/kobejayandy/article/details/52078275" target="_blank" rel="noopener">微服务架构的基础框架选择：Spring Cloud还是Dubbo？</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/uncategorized/2018/03/java-thread-summary.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/uncategorized/2018/03/java-thread-summary.html" itemprop="url">Java 线程知识整合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-21T23:29:54+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="线程简介"><a href="#线程简介" class="headerlink" title="线程简介"></a>线程简介</h2><p><del>线程：程序执行流的最小单元(进程的一个实体，是CPU调度和分派的基本单位)</del><br>    Java中的线程：java.lang.Thread类的一个实例</p>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">方法签名</th>
<th style="text-align:center">简介</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">java.lang.Runnable</td>
<td style="text-align:center">abstract void run()</td>
<td style="text-align:center">线程对象被调度之后所执行的操作</td>
</tr>
<tr>
<td style="text-align:center">java.lang.Thread</td>
<td style="text-align:center">Thread()</td>
<td style="text-align:center">新建一个线程</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Thread(String name)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Thread(Runnable target)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">synchronized void start()</td>
<td style="text-align:center">进入就绪状态</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">native void sleep(long millis)</td>
<td style="text-align:center">休眠一段时间,不会释放资源</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">static native void yield()</td>
<td style="text-align:center">与sleep()类似， 且只能让同优先级的线程有执行的机会</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">native boolean isAlive()</td>
<td style="text-align:center">run()方法结束之前返回true，新建、死亡状态返回false</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">static native Thread currentThread()</td>
<td style="text-align:center">方法返回当前正在使用CPU资源的线程</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">void interrupt()</td>
<td style="text-align:center">让休眠的线程发生InterruptedException异常，重新排队等待CPU资源</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">final void join()</td>
<td style="text-align:center">使main线程进入阻塞状态，等待调用join方法的线程执行</td>
</tr>
<tr>
<td style="text-align:center">java.lang.Object</td>
<td style="text-align:center">final void wait()</td>
<td style="text-align:center">等待状态，释放资源</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">final native void notify()</td>
<td style="text-align:center">从等待池唤醒任意一个线程，进入锁标志等待池</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">final native void notifyAll()</td>
<td style="text-align:center">唤醒所有等待池线程，进入锁标志等待池</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2 id="线程状态转换"><a href="#线程状态转换" class="headerlink" title="线程状态转换"></a>线程状态转换</h2><p><img src="http://img2.ph.126.net/Fi-L6WzEkYFuSI-qIltgNw==/166914661289627045.png" alt="Java-线程状态.png"> </p>
<ul>
<li>1、<strong>新建状态(New)</strong>：新创建了一个线程对象</li>
<li>2、<strong>就绪状态(Runnable)</strong>：线程对象创建后，其它线程调用了该对象的start()方法<ul>
<li>该状态的线程位于可执行线程池中，变得可执行，等待获取CPU的使用权</li>
</ul>
</li>
<li>3、<strong>执行状态(Running)</strong>：就绪状态的线程获取了CPU，执行程序代码。</li>
<li>4、<strong>堵塞状态(Blocked)</strong>：堵塞状态是线程由于某种原因放弃CPU使用权。临时停止执行。直到线程进入就绪状态，才有机会转到执行状态。堵塞的情况分三种<ul>
<li>4.1、<strong>等待堵塞</strong>：执行的线程执行<strong>wait()方法</strong>，JVM会把该线程放入等待池中<strong>(wait会释放持有的锁)</strong></li>
<li>4.2、<strong>同步堵塞</strong>：执行的线程在获取对象的同步锁时。若该<strong>同步锁被别的线程占用</strong>。则JVM会把该线程放入锁池中</li>
<li>4.3、<strong>其它堵塞</strong>：执行的线程执行sleep()或join()方法。或者发出了I/O请求时。JVM会把该线程置为堵塞状态。当sleep()状态超时、join()等待线程终止或者超时、或者I/O处理完毕时。线程又一次转入就绪状态。（注意,sleep是不会释放持有的锁)</li>
</ul>
</li>
<li>5、<strong>死亡状态(Dead)</strong>：线程执行完了或者因异常退出了run()方法，该线程结束生命周期。</li>
</ul>
<h2 id="创建线程的几种方式"><a href="#创建线程的几种方式" class="headerlink" title="创建线程的几种方式"></a>创建线程的几种方式</h2><ul>
<li>继承Thread类</li>
<li>实现Runnable接口</li>
<li>使用Executor框架创建线程池</li>
<li>实现Callable接口</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/SpringBoot/2018/03/idea-build-springboot-project.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/SpringBoot/2018/03/idea-build-springboot-project.html" itemprop="url">IDEA搭建SpringBoot+Mybatis项目</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-20T13:22:27+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index">
                    <span itemprop="name">SpringBoot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>SpringBoot简介：SpringBoot只使用一个核心配置文件，取消了一系列xml配置，甚至连web.xml都没有,全部使用注解的方式完成WEB层的功能。框架内置Tomcat服务器，运行启动类中的Main函数即可启动。
</code></pre><h2 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h2><p>IDEA 中 file – new – Project – Spring Initializr :</p>
<!-- ![新建project_0](IDEA搭建SpringBoot-Mybatis项目\新建project_0.jpg) -->
<img src="/SpringBoot/2018/03/idea-build-springboot-project/新建project_0.jpg">
<p>新建项目时<strong>Type</strong>：默认选的是<strong>Maven</strong>如果要使用<strong>Gradle</strong>构建项目，需要自己修改</p>
<!-- ![新建project_0](IDEA搭建SpringBoot-Mybatis项目\新建project_1.jpg) -->
<img src="/SpringBoot/2018/03/idea-build-springboot-project/新建project_1.jpg">
<p>勾上web就行</p>
<!-- ![新建project_0](IDEA搭建SpringBoot-Mybatis项目\新建project_2.jpg) -->
<img src="/SpringBoot/2018/03/idea-build-springboot-project/新建project_2.jpg">
<p>刚新建完成时的目录结构：<br><!-- ![新建project_0](IDEA搭建SpringBoot-Mybatis项目\SpringBoot_新建完成目录结构.jpg) --><br><img src="/SpringBoot/2018/03/idea-build-springboot-project/SpringBoot_新建完成目录结构.jpg"></p>
<h2 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h2><p><strong>自己新建一个数据库用于测试</strong></p>
<h3 id="pom-xml配置"><a href="#pom-xml配置" class="headerlink" title="pom.xml配置"></a>pom.xml配置</h3><p>pom.xml中配置所有相关的依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.leewf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxxxdemo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>xxxxdemo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mybatis-spring-boot.version</span>&gt;</span>1.2.0<span class="tag">&lt;/<span class="name">mybatis-spring-boot.version</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">mysql-connector.version</span>&gt;</span>5.1.39<span class="tag">&lt;/<span class="name">mysql-connector.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 导入需要依赖的包 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis-spring-boot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql-connector.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="application核心文件配置"><a href="#application核心文件配置" class="headerlink" title="application核心文件配置"></a>application核心文件配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server.port=8080</span><br><span class="line">#视图层控制</span><br><span class="line">spring.mvc.view.prefix=classpath:/templates/</span><br><span class="line">spring.mvc.view.suffix=.html</span><br><span class="line"></span><br><span class="line">spring.mvc.static-path-pattern=/static/**</span><br><span class="line"></span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?useUnicode=true&amp;useSSL=true&amp;characterEncoding=utf8</span><br><span class="line">spring.datasource.username=root  </span><br><span class="line">spring.datasource.password=123456</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"></span><br><span class="line">mybatis.typeAliasesPackage=com.leewf.xxxxdemo.entity</span><br></pre></td></tr></table></figure>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="完善代码"><a href="#完善代码" class="headerlink" title="完善代码"></a>完善代码</h3><p><strong>代码完善后结构</strong><br><!-- ![新建project_0](IDEA搭建SpringBoot-Mybatis项目\SpringBoot_完善目录结构.jpg) --><br><img src="/SpringBoot/2018/03/idea-build-springboot-project/SpringBoot_完善目录结构.jpg"></p>
<p>####User类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">        <span class="keyword">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line">    ……</span><br></pre></td></tr></table></figure></p>
<h4 id="UserMapper接口"><a href="#UserMapper接口" class="headerlink" title="UserMapper接口"></a>UserMapper接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user where id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function">User <span class="title">selectUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"insert into user(username,password) values(#&#123;username&#125;,#&#123;password&#125;) "</span>)</span><br><span class="line">    <span class="function">Boolean <span class="title">insertUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="UserService接口实现类UserServiceImpl"><a href="#UserService接口实现类UserServiceImpl" class="headerlink" title="UserService接口实现类UserServiceImpl"></a>UserService接口实现类UserServiceImpl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserMapper userMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">selectUser</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.selectUser(id);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">insertUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.insertUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="UserController类"><a href="#UserController类" class="headerlink" title="UserController类"></a>UserController类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/show/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">selectUser</span><span class="params">(@PathVariable <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.selectUser(id).toString();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    @RequestMapping("/insert")</span></span><br><span class="line"><span class="comment">    public Boolean insertUser(User user)&#123;</span></span><br><span class="line"><span class="comment">            return userService.insertUser(user);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="测试查询数据"><a href="#测试查询数据" class="headerlink" title="测试查询数据"></a>测试查询数据</h3><p>打开浏览器访问<code>http://localhost:8080/show/2</code><br><!-- ![新建project_0](IDEA搭建SpringBoot-Mybatis项目\SpringBoot_查询测试.jpg) --><br><img src="/SpringBoot/2018/03/idea-build-springboot-project/SpringBoot_查询测试.jpg"></p>
<h3 id="测试插入数据"><a href="#测试插入数据" class="headerlink" title="测试插入数据"></a>测试插入数据</h3><h4 id="UserTest测试类"><a href="#UserTest测试类" class="headerlink" title="UserTest测试类"></a>UserTest测试类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"com.leewf.xxxxdemo.mapper"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">"张三"</span>,<span class="string">"000"</span>);</span><br><span class="line">        System.out.println(<span class="string">"插入数据："</span>+userService.insertUser(user));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/uncategorized/2018/03/shiro-simple-studying.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/uncategorized/2018/03/shiro-simple-studying.html" itemprop="url">Shiro 简单教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T21:22:51+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apache Shiro 是 Java 的一个安全框架，可以帮助我们完成：认证、授权、加密、会话管理、与 Web 集成、缓 存等等。</span><br></pre></td></tr></table></figure>
<h2 id="Shiro-图解"><a href="#Shiro-图解" class="headerlink" title="Shiro 图解"></a>Shiro 图解</h2><h3 id="Shiro基本功能点"><a href="#Shiro基本功能点" class="headerlink" title="Shiro基本功能点"></a>Shiro基本功能点</h3><p> <img src="http://img2.ph.126.net/WTS4yhvmPEklut7esCnK3Q==/6632684047793499152.png" alt="Shiro基本功能点.png"><br><strong>Authentication：</strong>身份认证/登录，验证用户是不是拥有相应的身份<br><strong>Authorization：</strong>授权，验证某个已认证的用户是否拥有某个权限<br><strong>Session Manager：</strong>会话管理，即用户登录后就是一次会话，在没有退出之前，它的所有信 息都在会话中<br><strong>Cryptography：</strong>加密，保护数据的安全性，如密码加密存储到数据库<br><strong>Caching：</strong>缓存，比如用户登录后，其用户信息、拥有的角色/权限不必每次去查<br><strong>Concurrency：</strong>支持多线程应用的并发验证，即如在一个线程中开启另一个线程，能 把权限自动传播过去<br><strong>Testing：</strong>提供测试支持<br><strong>Run As：</strong>允许一个用户假装为另一个用户(如果他们允许)的身份进行访问<br><strong>Remember Me：</strong>非常常见的功能，即一次登录后，下次再来的话不用登录</p>
<h3 id="Shiro基本架构"><a href="#Shiro基本架构" class="headerlink" title="Shiro基本架构"></a>Shiro基本架构</h3><p><img src="http://img2.ph.126.net/U4OduhXixc3O2_0u44jbeQ==/90353467544291033.png" alt="Shiro架构.png"></p>
<p><strong>Subject：</strong>主体，代表了当前“用户”，所有的Subject 都会绑定到SecurityManager，与Subject 的所有交互都会委托给 SecurityManager，SecurityManager 是实际的执行者。<br><strong>SecurityManager：</strong>安全管理器，管理着所有 Subject，可以看出它是 Shiro 的核心，负责与其他组件进行交互。<br><strong>Realm：</strong>域，可以把Realm 看成DataSource，即安全数据源。，Shiro 需要从Realm 获取(如用户、角色、权限)安全数据(Realm需要开发者提供)，</p>
<h3 id="Shiiro-内部架构图"><a href="#Shiiro-内部架构图" class="headerlink" title="Shiiro 内部架构图"></a>Shiiro 内部架构图</h3><p><img src="http://img2.ph.126.net/gZcGsisIwgwFo-bKObnhoQ==/140737488455682878.jpg" alt="Shiro-内部架构.jpg"></p>
<p><strong>参考文献</strong></p>
<p><a href="https://shiro.apache.org/documentation.html" target="_blank" rel="noopener">官方文档</a><br><a href="https://www.jianshu.com/p/5a35d0100a71" target="_blank" rel="noopener">Shiro入门教程</a><br>[跟我学Shiro教程 张开涛著]</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/Java/2018/03/java-collection-summary.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2018/03/java-collection-summary.html" itemprop="url">Java 集合知识整合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T10:12:58+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html" target="_blank" rel="noopener">官方文档</a></p>
<h2 id="Java集合图解"><a href="#Java集合图解" class="headerlink" title="Java集合图解"></a>Java集合图解</h2><h3 id="Java集合框架的UML类图"><a href="#Java集合框架的UML类图" class="headerlink" title="Java集合框架的UML类图"></a>Java集合框架的UML类图</h3><!--![Java-集合框架的UML类图](/Java-集合知识整合/Java-集合框架的UML类图.jpg)-->
<img src="/Java/2018/03/java-collection-summary/Java-集合框架的UML类图.jpg">
<h3 id="Java集合框架-思维导图"><a href="#Java集合框架-思维导图" class="headerlink" title="Java集合框架-思维导图"></a>Java集合框架-思维导图</h3><!-- ![Java-集合框架的UML类图](/Java-集合知识整合/Java-集合框架-思维导图.jpg)-->
<img src="/Java/2018/03/java-collection-summary/Java-集合框架-思维导图.jpg">
<h3 id="各集合类型对比"><a href="#各集合类型对比" class="headerlink" title="各集合类型对比"></a>各集合类型对比</h3><table>
<thead>
<tr>
<th style="text-align:center">集合类型</th>
<th style="text-align:center">结构</th>
<th style="text-align:center">排列顺序</th>
<th style="text-align:center">线程安全</th>
<th style="text-align:center">能否包含Null</th>
<th style="text-align:center">其他特点</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">List</td>
<td style="text-align:center"></td>
<td style="text-align:center">有序</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">LinkedList</td>
<td style="text-align:center">双向链表</td>
<td style="text-align:center">有序</td>
<td style="text-align:center"></td>
<td style="text-align:center">能</td>
<td style="text-align:center">插入快、查询慢</td>
</tr>
<tr>
<td style="text-align:center">ArrayList</td>
<td style="text-align:center">数组结构</td>
<td style="text-align:center">有序</td>
<td style="text-align:center">不安全</td>
<td style="text-align:center">能</td>
<td style="text-align:center">插入慢、查询快</td>
</tr>
<tr>
<td style="text-align:center">Vector</td>
<td style="text-align:center">数组结构</td>
<td style="text-align:center">有序</td>
<td style="text-align:center">线程安全</td>
<td style="text-align:center">能</td>
<td style="text-align:center">插入慢、查询慢</td>
</tr>
<tr>
<td style="text-align:center">Set</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">元素唯一</td>
</tr>
<tr>
<td style="text-align:center">HashSet</td>
<td style="text-align:center">哈希表</td>
<td style="text-align:center">无序</td>
<td style="text-align:center"></td>
<td style="text-align:center">能有一个Null值</td>
<td style="text-align:center">元素唯一</td>
</tr>
<tr>
<td style="text-align:center">TreeSet</td>
<td style="text-align:center">二叉树</td>
<td style="text-align:center">有序</td>
<td style="text-align:center"></td>
<td style="text-align:center">不能有Null值</td>
<td style="text-align:center">元素唯一</td>
</tr>
<tr>
<td style="text-align:center">Map</td>
<td style="text-align:center">&lt;Key,Value&gt;</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">Key唯一</td>
</tr>
<tr>
<td style="text-align:center">HashMap</td>
<td style="text-align:center">哈希表</td>
<td style="text-align:center">无序</td>
<td style="text-align:center">不安全</td>
<td style="text-align:center">Key只能一个Null，Value能为Null</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">HashTable</td>
<td style="text-align:center">哈希表</td>
<td style="text-align:center">无序</td>
<td style="text-align:center">线程安全</td>
<td style="text-align:center">Key只能一个Null，Value能为Null</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">TreeMap</td>
<td style="text-align:center">树状结构</td>
<td style="text-align:center">有序</td>
<td style="text-align:center"></td>
<td style="text-align:center">Key不能为Null，Value能为Null</td>
<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<h2 id="Collection接口"><a href="#Collection接口" class="headerlink" title="Collection接口"></a>Collection接口</h2><p>Collection接口是最基本的容器接口</p>
<p><strong>父接口：</strong>Iterable<e></e></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Collection</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">Iterable</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>主要接口及实现类</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Collection</span><br><span class="line">    ├ List</span><br><span class="line">    │ ├ LinkedList</span><br><span class="line">    │ ├ ArrayList</span><br><span class="line">    │ └ Vector</span><br><span class="line">    │　  └ Stack</span><br><span class="line">    └ Set</span><br><span class="line">      ├ HashSet</span><br><span class="line">      └ TreeSet</span><br></pre></td></tr></table></figure>
<h3 id="List接口"><a href="#List接口" class="headerlink" title="List接口"></a>List接口</h3><p><strong>所有父接口：</strong>Collection<e>, Iterable<e></e></e></p>
<p><strong>特点：</strong><br>元素是有序的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">Collection</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList"></a>LinkedList</h4><p><strong>所有父接口：</strong>Serializable, Cloneable, Iterable<e>, Collection<e>, Deque<e>, List<e>, Queue<e></e></e></e></e></e></p>
<p><strong>特点：</strong><br>双向链表结构，更便于修改数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractSequentialList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">Deque</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ArrayList"><a href="#ArrayList" class="headerlink" title="ArrayList"></a>ArrayList</h4><p><strong>所有父接口：</strong>Serializable, Cloneable, Iterable<e>, Collection<e>, List<e>, RandomAccess</e></e></e></p>
<p><strong>特点：</strong><br>数组结构，更便于查询炒作<br>线程不同步</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h4><p><strong>所有父接口：</strong>Serializable, Cloneable, Iterable<e>, Collection<e>, List<e>, RandomAccess</e></e></e></p>
<p><strong>特点：</strong><br>数组结构<br>线程同步，查询与修改都缓慢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vector</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Set接口"><a href="#Set接口" class="headerlink" title="Set接口"></a>Set接口</h3><p><strong>所有父接口：</strong>Collection<e>, Iterable<e></e></e></p>
<p><strong>特点：</strong><br>不能插入重复元素<br>最多包含一个null元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Set</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">Collection</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HashSet类"><a href="#HashSet类" class="headerlink" title="HashSet类"></a>HashSet类</h4><p><strong>所有父接口：</strong>Serializable, Cloneable, Iterable<e>, Collection<e>, Set<e></e></e></e></p>
<p><strong>特点：</strong><br>基于hashMap类实现<br>元素是无序的<br>最多包含一个null元素<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Set</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="HashSet类内部对hashMap类的操作"><a href="#HashSet类内部对hashMap类的操作" class="headerlink" title="HashSet类内部对hashMap类的操作"></a>HashSet类内部对hashMap类的操作</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object PRESENT = <span class="keyword">new</span> Object();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> HashMap&lt;E,Object&gt; map;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>&#123;</span><br><span class="line">   	<span class="keyword">return</span> map.put(e, PRESENT)==<span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> map.remove(o)==PRESENT;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h4 id="TreeSet类"><a href="#TreeSet类" class="headerlink" title="TreeSet类"></a>TreeSet类</h4><p><strong>所有父接口：</strong>Serializable, Cloneable, Iterable<e>, Collection<e>, NavigableSet<e>, Set<e>, SortedSet<e></e></e></e></e></e></p>
<p><strong>特点：</strong><br>基于NavigableMap类实现<br>二叉树结构<br>元素是有序的<br>不能包含null元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeSet</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">NavigableSet</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Map接口"><a href="#Map接口" class="headerlink" title="Map接口"></a>Map接口</h2><p><strong>所有父接口：</strong>无<br><strong>特点：</strong><br>“key-value”储存结构<br>key - 可以为null，但不能重复</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="HashMap类"><a href="#HashMap类" class="headerlink" title="HashMap类"></a>HashMap类</h3><p><strong>所有父接口：</strong>Serializable, Cloneable, Map&lt;K,V&gt;<br><strong>特点：</strong><br>基于哈希表实现<br>线程不同步</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="HashTable类"><a href="#HashTable类" class="headerlink" title="HashTable类"></a>HashTable类</h3><p><strong>所有父接口：</strong>Serializable, Cloneable, Map&lt;K,V&gt;</p>
<p><strong>官方：</strong>This class implements a hash table, which maps keys to values. Any non-null object can be used as a key or as a value.</p>
<p><strong>特点：</strong><br>基于哈希表实现<br>线程同步<br>key和value都不能为null</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hashtable</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">Dictionary</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TreeMap类"><a href="#TreeMap类" class="headerlink" title="TreeMap类"></a>TreeMap类</h3><p><strong>所有父接口：</strong>Serializable, Cloneable, Map&lt;K,V&gt;, NavigableMap&lt;K,V&gt;, SortedMap&lt;K,V&gt;</p>
<p><strong>官方：</strong>A Red-Black tree based NavigableMap implementation. The map is sorted according to the natural ordering of its keys, or by a Comparator provided at map creation time, depending on which constructor is used.</p>
<p><strong>特点：</strong><br>树状结构<br>key 不能为null，value 可以为null</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">NavigableMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br></pre></td></tr></table></figure>
<p><strong>参考链接</strong><br><a href="https://my.oschina.net/u/2331760/blog/406154" target="_blank" rel="noopener">java list用法示例详解</a><br><a href="http://blog.csdn.net/geduo_83/article/details/20613233" target="_blank" rel="noopener">HashSet和TreeSet有和异同</a><br><a href="http://blog.csdn.net/lcore/article/details/8868943" target="_blank" rel="noopener">Thinking in Java之集合框架浅析</a><br><a href="http://blog.csdn.net/lcore/article/details/8869937" target="_blank" rel="noopener">Thinking in Java之深入Collection源码学习</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/Java/2018/03/java-object-class.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2018/03/java-object-class.html" itemprop="url">Java Object类详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-18T18:12:33+08:00">
                2018-03-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>Object是所有类的父类，任何类都默认继承Object类
九个方法:getClass(),hashCode(),equals(),clone(),toString(),notify(),notifyAll(),wait(),finalize()
final方法：getClass(),notify(),notifyAll(),wait()
</code></pre><p><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html" target="_blank" rel="noopener">官方文档</a></p>
<h2 id="getClass-方法"><a href="#getClass-方法" class="headerlink" title="getClass()方法"></a>getClass()方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> Class&lt;?&gt; getClass();</span><br></pre></td></tr></table></figure>
<p>官方：Returns the runtime class of this Object.<br>返回 正在运行的实例化对象的Class</p>
<h2 id="hashCode-方法"><a href="#hashCode-方法" class="headerlink" title="hashCode()方法"></a>hashCode()方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>官方：Returns a hash code value for the object.<br>返回 该对象的哈希码值</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>该方法用于哈希查找，可以减少在查找中使用equals的次数，重写了equals方法一般都要重写hashCode方法</p>
<p>这个方法在一些具有哈希功能的Collection中用到(例如：hashMap、hashSet)</p>
<h3 id="hashCode-官方规定"><a href="#hashCode-官方规定" class="headerlink" title="hashCode()官方规定"></a>hashCode()官方规定</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">The general contract of hashCode is:</span><br><span class="line">* Whenever it is invoked on the same object more than once during an execution of a Java application, the hashCode method must consistently return the same integer, provided no information used in equals comparisons on the object is modified. This integer need not remain consistent from one execution of an application to another execution of the same application.</span><br><span class="line">* If two objects are equal according to the equals(Object) method, then calling the hashCode method on each of the two objects must produce the same integer result.</span><br><span class="line">* It is not required that if two objects are unequal according to the equals(java.lang.Object) method, then calling the hashCode method on each of the two objects must produce distinct integer results. However, the programmer should be aware that producing distinct integer results for unequal objects may improve the performance of hash tables.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hashCode一般的规定：</span><br><span class="line">* 在 Java 应用程序执行期间，在对同一对象多次调用hashCode 方法时，必须一致地返回相同的整数，前提是将对象进行equals 比较时所用的信息没有被修改。从某一应用程序的一次执行到同一应用程序的另一次执行，该整数无需保持一致。 </span><br><span class="line">* 如果根据equals(Object) 方法，两个对象是相等的，那么对这两个对象中的每个对象调用 hashCode 方法都必须生成相同的整数结果。   </span><br><span class="line">* 如果根据equals(java.lang.Object) 方法，两个对象不相等，那么对这两个对象中的任一对象上调用 hashCode 方法不 要求一定生成不同的整数结果。但是，程序员应该意识到，为不相等的对象生成不同整数结果可以提高哈希表的性能。</span><br></pre></td></tr></table></figure>
<h3 id="hashCode-与equal-的关系"><a href="#hashCode-与equal-的关系" class="headerlink" title="hashCode()与equal()的关系"></a>hashCode()与equal()的关系</h3><p>equal() 返回true，则两个对象的hashCode() 的值必须是一样的<br>equal() 返回false，两个对象的hashCode() 的值可能不一样，但不相等的对象生成不同hashCode 值可以提高哈希表的性能</p>
<h2 id="equal-方法"><a href="#equal-方法" class="headerlink" title="equal() 方法"></a>equal() 方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>官方：Indicates whether some other object is “equal to” this one.</p>
<p>Object 中equal() 方法用来判断调用equals() 的对象和obj 所引用的对象是否是同一对象(同一对象：内存中的同一块存储单元)，即便是内容完全相等的两块不同的内存对象，也会返回false</p>
<p>如果希望不同内存但相同内容的两个对象equals时返回true，则我们需要重写父类的equal方法</p>
<h2 id="clone-方法"><a href="#clone-方法" class="headerlink" title="clone() 方法"></a>clone() 方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span>;</span><br></pre></td></tr></table></figure>
<p>官方：Creates and returns a copy of this object.</p>
<ul>
<li><strong>需要实现Cloneable</strong><br>如果此对象的类不能实现接口Cloneable，则会抛出CloneNotSupportedException</li>
<li><strong>执行的是”浅拷贝”操作</strong><br>该方法将创建该对象类的一个新实例，并用该赋值对象的相应字段的所有内容初始化其字段，这些字段的内容本身并不被克隆。因此，此方法执行此对象的“浅拷贝”，而不是“深拷贝”操作</li>
</ul>
<h3 id="浅拷贝-Shallow-Clone-和-深拷贝-Deep-Clone"><a href="#浅拷贝-Shallow-Clone-和-深拷贝-Deep-Clone" class="headerlink" title="浅拷贝(Shallow Clone) 和 深拷贝(Deep Clone)"></a>浅拷贝(Shallow Clone) 和 深拷贝(Deep Clone)</h3><!--![浅拷贝和深拷贝](/Java-Object类详解/Java-浅拷贝和深拷贝.jpg)-->
<img src="/Java/2018/03/java-object-class/Java-浅拷贝和深拷贝.jpg">
<p>浅拷贝：只复制一个对象，传递引用，不能复制实例<br>深拷贝：复制一个对象，对对象内部的引用的实例也进行复制</p>
<h4 id="实现深拷贝-Deep-Clone"><a href="#实现深拷贝-Deep-Clone" class="headerlink" title="实现深拷贝(Deep Clone)"></a>实现深拷贝(Deep Clone)</h4><p>深拷贝几种思路:</p>
<ul>
<li>序列化</li>
<li>内部创建新对象构造</li>
<li>采用cloneabel接口进行深拷贝</li>
</ul>
<h3 id="clone与copy的区别"><a href="#clone与copy的区别" class="headerlink" title="clone与copy的区别"></a>clone与copy的区别</h3><p>假设有一个User对象，简单的copy如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User user = new User(18,&quot;李四&quot;);</span><br><span class="line">User user1 = user;</span><br></pre></td></tr></table></figure></p>
<!-- ![Java-copy和浅拷贝](/Java-Object类详解/Java-copy和浅拷贝.jpg) -->
<img src="/Java/2018/03/java-object-class/Java-copy和浅拷贝.jpg">
<h3 id="clone方法的保护机制"><a href="#clone方法的保护机制" class="headerlink" title="clone方法的保护机制"></a>clone方法的保护机制</h3><p>Object中Clone()是被声明为protected的，例如User类，这样保证只有User类里面才能“克隆”User对象</p>
<h3 id="clone方法的使用"><a href="#clone方法的使用" class="headerlink" title="clone方法的使用"></a>clone方法的使用</h3><ul>
<li>注意<ul>
<li>什么时候使用shallow Clone，什么时候使用deep Clone</li>
<li>调用Clone()方法的对象所属的类(Class)必须implements Clonable接口</li>
</ul>
</li>
</ul>
<p>详细可参考：<a href="http://blog.csdn.net/zhangjg_blog/article/details/18369201#0-qzone-1-28144-d020d2d2a4e8d1a374a433f596ad1440" target="_blank" rel="noopener">详解Java中的clone方法 – 原型模式</a></p>
<h3 id="Throws"><a href="#Throws" class="headerlink" title="Throws"></a>Throws</h3><p><code>CloneNotSupportedException</code> - if the object’s class does not support the <code>Cloneable</code> interface. Subclasses that override the <code>clone</code> method can also throw this exception to indicate that an instance cannot be cloned.</p>
<h2 id="toString-方法"><a href="#toString-方法" class="headerlink" title="toString()方法"></a>toString()方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getClass().getName() + <span class="string">"@"</span> + Integer.toHexString(hashCode());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>官方：Returns a string representation of the object. In general</p>
<p>Object 类的 toString()方法返回一个字符串，该字符串由<strong>“类名(对象是该类的一个实例)”+“@”+”此对象哈希码的无符号十六进制表示”</strong>组成</p>
<h2 id="notify-方法"><a href="#notify-方法" class="headerlink" title="notify()方法"></a>notify()方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>官方：Wakes up a single thread that is waiting on this object’s monitor. If any threads are waiting on this object, one of them is chosen to be awakened. The choice is arbitrary and occurs at the discretion of the implementation.</p>
<p>唤醒在该对象上等待的某个线程。</p>
<h3 id="Throws-1"><a href="#Throws-1" class="headerlink" title="Throws"></a>Throws</h3><p><code>IllegalMonitorStateException</code> - if the current thread is not the owner of this object’s monitor.</p>
<h2 id="notifyAll-方法"><a href="#notifyAll-方法" class="headerlink" title="notifyAll()方法"></a>notifyAll()方法</h2><p>官方：Wakes up all threads that are waiting on this object’s monitor. A thread waits on an object’s monitor by calling one of the wait methods.</p>
<p>该方法唤醒在该对象上等待的所有线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">notifyAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Throws-2"><a href="#Throws-2" class="headerlink" title="Throws"></a>Throws</h3><p><code>IllegalMonitorStateException</code> - if the current thread is not the owner of this object’s monitor.</p>
<h2 id="wait-方法"><a href="#wait-方法" class="headerlink" title="wait()方法"></a>wait()方法</h2><h3 id="wait"><a href="#wait" class="headerlink" title="wait()"></a>wait()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">wait</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        wait(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>官方：Causes the current thread to wait until another thread invokes the notify() method or the     notifyAll() method for this object.</p>
<p>等待另一个线程调用该对象的方法或notify()、notifyall()方法</p>
<h4 id="Throws-3"><a href="#Throws-3" class="headerlink" title="Throws"></a>Throws</h4><p><code>IllegalMonitorStateException</code> - if the current thread is not the owner of the object’s monitor.<br><code>InterruptedException</code> - if any thread interrupted the current thread before or while the current thread was waiting for a notification. The <em>interrupted status</em> of the current thread is cleared when this exception is thrown.</p>
<h3 id="wait-long-timeout"><a href="#wait-long-timeout" class="headerlink" title="wait(long timeout)"></a>wait(long timeout)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">wait</span><span class="params">(<span class="keyword">long</span> timeout)</span> <span class="keyword">throws</span> InterruptedException</span>;</span><br></pre></td></tr></table></figure>
<p>官方：Causes the current thread to wait until either another thread invokes the notify() method or the notifyAll()  method for this object, or a specified amount of time has elapsed.</p>
<p>等待另一个线程调用该对象的方法或notify()、notifyall()方法，或超过设置时间</p>
<h4 id="Throws-4"><a href="#Throws-4" class="headerlink" title="Throws:"></a>Throws:</h4><p><code>IllegalArgumentException</code> - if the value of timeout is negative.<br><code>IllegalMonitorStateException</code> - if the current thread is not the owner of the object’s monitor.<br><code>InterruptedException</code> - if any thread interrupted the current thread before or while the current thread was waiting for a notification. The <em>interrupted status</em> of the current thread is cleared when this exception is thrown.</p>
<h3 id="wait-long-timeout-int-nanos"><a href="#wait-long-timeout-int-nanos" class="headerlink" title="wait(long timeout, int nanos)"></a>wait(long timeout, int nanos)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">wait</span><span class="params">(<span class="keyword">long</span> timeout, <span class="keyword">int</span> nanos)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timeout &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"timeout value is negative"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nanos &lt; <span class="number">0</span> || nanos &gt; <span class="number">999999</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">                                <span class="string">"nanosecond timeout value out of range"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nanos &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            timeout++;</span><br><span class="line">        &#125;</span><br><span class="line">        wait(timeout);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>官方：Causes the current thread to wait until another thread invokes the notify() method or the notifyAll() method for this object, or some other thread interrupts the current thread, or a certain amount of real time has elapsed.</p>
<h4 id="Throws-5"><a href="#Throws-5" class="headerlink" title="Throws"></a>Throws</h4><p><code>IllegalArgumentException</code> - if the value of timeout is negative or the value of nanos is not in the range 0-999999.<br><code>IllegalMonitorStateException</code> - if the current thread is not the owner of this object’s monitor.<br><code>InterruptedException</code> - if any thread interrupted the current thread before or while the current thread was waiting for a notification. The <em>interrupted status</em> of the current thread is cleared when this exception is thrown.</p>
<hr>
<h2 id="finalize-方法"><a href="#finalize-方法" class="headerlink" title="finalize()方法"></a>finalize()方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>官方：Called by the garbage collector on an object when garbage collection determines that there are no more references to the object</p>
<p>用于释放资源。因为无法确定该方法什么时候被调用，很少使用</p>
<p>Java允许在类中定义一个名为finalize()的方法。它的工作原理是：一旦垃圾回收器准备好释放对象占用的存储空间，将首先调用其finalize()方法。并且在下一次垃圾回收动作发生时，才会真正回收对象占用的内存。</p>
<h3 id="关于垃圾回收"><a href="#关于垃圾回收" class="headerlink" title="关于垃圾回收"></a>关于垃圾回收</h3><ul>
<li>对象可能不被垃圾回收。只要程序没有濒临存储空间用完的那一刻，对象占用的空间就得不到释放。</li>
<li>垃圾回收并不等于“析构”。</li>
<li>垃圾回收只与内存有关。使用垃圾回收的唯一原因是为了回收程序不再使用的内存。</li>
</ul>
<h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>无论对象是如何创建的，垃圾回收器都会负责释放对象占据的所有内存。这就将对finalize()的需求限制到一种特殊情况，即通过某种创建对象方式以外的方式为对象分配了存储空间。<br>不过这种情况一般发生在使用“本地方法”的情况下，本地方法是一种在Java中调用非Java代码的方式。</p>
<h3 id="Throws-6"><a href="#Throws-6" class="headerlink" title="Throws"></a>Throws</h3><p><code>Throwable</code> - the <code>Exception</code> raised by this method</p>
<hr>
<p><strong>参考文献</strong><br>[1]<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html</a><br>[2]<a href="https://www.cnblogs.com/zhangyinhua/p/7715486.html#_label3" target="_blank" rel="noopener">https://www.cnblogs.com/zhangyinhua/p/7715486.html#_label3</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/Redis/2018/03/cjl6f9v6u0013soq6lnbwl524.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Redis/2018/03/cjl6f9v6u0013soq6lnbwl524.html" itemprop="url">Windows Redis服务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-18T12:22:20+08:00">
                2018-03-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Redis/" itemprop="url" rel="index">
                    <span itemprop="name">Redis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Windows安装Redis"><a href="#Windows安装Redis" class="headerlink" title="Windows安装Redis"></a>Windows安装Redis</h2><p>首先<strong>Redis</strong>官方并不支持<strong>Windows</strong>，而<strong>Windows</strong>版的<strong>Redis</strong>是由<a href="https://github.com/MSOpenTech" target="_blank" rel="noopener"><strong>MSOpenTech</strong></a>提供的支持，所以首先去下载一个发布版，我选择的是<a href="https://github.com/MSOpenTech/redis/releases/download/win-3.2.100/Redis-x64-3.2.100.zip" target="_blank" rel="noopener"><strong>Redis-x64-3.2.100.zip</strong></a>压缩包，解压缩得到如下文件列表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">EventLog.dll</span><br><span class="line">Redis on Windows Release Notes.docx</span><br><span class="line">Redis on Windows.docx</span><br><span class="line">redis.windows.conf								# 配置文件</span><br><span class="line">redis.windows-service.conf						 </span><br><span class="line">redis-benchmark.exe							 	# 基准测试  </span><br><span class="line">redis-benchmark.pdb</span><br><span class="line">redis-check-aof.exe								# aof  </span><br><span class="line">redis-check-aof.pdb</span><br><span class="line">redis-cli.exe									# 客户端</span><br><span class="line">redis-cli.pdb	</span><br><span class="line">redis-server.exe								# 服务器  </span><br><span class="line">redis-server.pdb</span><br><span class="line">Windows Service Documentation.docx</span><br></pre></td></tr></table></figure></p>
<p>有了这些文件之后，就可以开始安装服务了<br><code>redis-server.exe  redis.windows.conf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2.100&gt;redis-server.exe  redis.windows.conf</span><br><span class="line"></span><br><span class="line">                _._</span><br><span class="line">           _.-``__ &apos;&apos;-._</span><br><span class="line">      _.-``    `.  `_.  &apos;&apos;-._           Redis 3.2.100 (00000000/0) 64 bit</span><br><span class="line">  .-`` .-```.  ```\/    _.,_ &apos;&apos;-._</span><br><span class="line"> (    &apos;      ,       .-`  | `,    )     Running in standalone mode</span><br><span class="line"> |`-._`-...-` __...-.``-._|&apos;` _.-&apos;|     Port: 6379</span><br><span class="line"> |    `-._   `._    /     _.-&apos;    |     PID: 14732</span><br><span class="line">  `-._    `-._  `-./  _.-&apos;    _.-&apos;</span><br><span class="line"> |`-._`-._    `-.__.-&apos;    _.-&apos;_.-&apos;|</span><br><span class="line"> |    `-._`-._        _.-&apos;_.-&apos;    |           http://redis.io</span><br><span class="line">  `-._    `-._`-.__.-&apos;_.-&apos;    _.-&apos;</span><br><span class="line"> |`-._`-._    `-.__.-&apos;    _.-&apos;_.-&apos;|</span><br><span class="line"> |    `-._`-._        _.-&apos;_.-&apos;    |</span><br><span class="line">  `-._    `-._`-.__.-&apos;_.-&apos;    _.-&apos;</span><br><span class="line">      `-._    `-.__.-&apos;    _.-&apos;</span><br><span class="line">          `-._        _.-&apos;</span><br><span class="line">              `-.__.-&apos;</span><br><span class="line"></span><br><span class="line">[14732] 18 Mar 12:38:16.581 # Server started, Redis version 3.2.100</span><br><span class="line">[14732] 18 Mar 12:38:16.583 * The server is now ready to accept connections on port 6379</span><br></pre></td></tr></table></figure></p>
<p>在启动成功之后，可以使用自带的客户端工具进行测试。双击打开<code>redis-cli.exe</code>，如果成功连接上之后就可以进行<strong>set</strong>及<strong>get</strong>等操作了。如果需要帮助，可以输入<strong>help</strong>查看。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set &quot;key&quot; &quot;testValue&quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get &quot;key&quot;</span><br><span class="line">&quot;testValue&quot;</span><br><span class="line">127.0.0.1:6379&gt; help</span><br><span class="line">redis-cli 3.2.100</span><br><span class="line">To get help about Redis commands type:</span><br><span class="line">      &quot;help @&lt;group&gt;&quot; to get a list of commands in &lt;group&gt;</span><br><span class="line">      &quot;help &lt;command&gt;&quot; for help on &lt;command&gt;</span><br><span class="line">      &quot;help &lt;tab&gt;&quot; to get a list of possible help topics</span><br><span class="line">      &quot;quit&quot; to exit</span><br><span class="line">To set redis-cli perferences:</span><br><span class="line">      &quot;:set hints&quot; enable online hints</span><br><span class="line">      &quot;:set nohints&quot; disable online hints</span><br><span class="line">Set your preferences in ~/.redisclirc</span><br></pre></td></tr></table></figure></p>
<p>再输入<strong>help</strong>空格，然后敲<strong>tab</strong>键，可以像命令提示符一样显示候选项。通常不需要每次都使用<strong>cmd</strong>界面去操作，所以附上一些快速处理的脚本，注意在安装服务之前先关闭防火墙和杀毒软件，否则安装不成功。</p>
<h2 id="快速操作脚本"><a href="#快速操作脚本" class="headerlink" title="快速操作脚本"></a>快速操作脚本</h2><h3 id="注册服务"><a href="#注册服务" class="headerlink" title="注册服务"></a>注册服务</h3><p><code>service-install.bat</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server --service-install redis.windows.conf</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<p>注册成功之后输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2.100&gt;redis-server --service-install redis.windows.conf</span><br><span class="line">[13868] 26 Dec 09:39:58.364 # Granting read/write access to ‘NT AUTHORITY\Networ</span><br><span class="line">kService’ on: “D:\Redis-x64-3.2.100” “D:\Redis-x64-3.2.100\”</span><br><span class="line">[13868] 26 Dec 09:39:58.365 # Redis successfully installed as a service.</span><br><span class="line">D:\Redis-x64-3.2.100&gt;pause</span><br><span class="line">请按任意键继续. . .</span><br></pre></td></tr></table></figure>
<h3 id="卸载服务"><a href="#卸载服务" class="headerlink" title="卸载服务"></a>卸载服务</h3><p><code>uninstall-service.bat</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server –service-uninstall</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<p>卸载成功之后输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2.100&gt;redis-server -–service-uninstall</span><br><span class="line">[11368] 26 Dec 09:45:47.460 # Redis service successfully uninstalled.</span><br><span class="line">D:\Redis-x64-3.2.100&gt;pause</span><br><span class="line">请按任意键继续. . .</span><br></pre></td></tr></table></figure>
<p>注意在卸载服务之前，需要先去<strong>控制面板|管理工具|服务|停止Redis服务</strong>，然后才能卸载成功。</p>
<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><p><code>starting-service.bat</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server -–service-start</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<p>服务启动成功之后输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2.100&gt;redis-server –-service-start</span><br><span class="line">[2380] 18 Mar 15:10:07.771 # Redis service successfully started.</span><br><span class="line">D:\Redis-x64-3.2.100&gt;pause</span><br><span class="line">请按任意键继续. . .</span><br></pre></td></tr></table></figure>
<h3 id="停止服务"><a href="#停止服务" class="headerlink" title="停止服务"></a>停止服务</h3><p><code>stopping-service.bat</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server –service-stop</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>
<p>服务停止成功之后输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2.100&gt;redis-server –service-stop</span><br><span class="line">[19612] 26 Dec 10:19:27.974 # Redis service successfully stopped.</span><br><span class="line">D:\Redis-x64-3.2.100&gt;pause</span><br><span class="line">请按任意键继续. . .</span><br></pre></td></tr></table></figure>
<h2 id="命名服务"><a href="#命名服务" class="headerlink" title="命名服务"></a>命名服务</h2><p>命名服务，一个可选的参数可以用来指定安装的服务的名称，这个参数可以跟在<code>service-install</code>、<code>service-start</code>、<code>service-stop</code>或<code>service-uninstall</code>命令的后面。</p>
<p>比如以下命令会安装和启动三个独立的Redis实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis-server –-service-install -–service-name redisService1 --port 10001</span><br><span class="line">redis-server –-service-start –-service-name redisService1</span><br><span class="line">redis-server –-service-install –-service-name redisService2 –-port 10002</span><br><span class="line">redis-server –-service-start –-service-name redisService2</span><br><span class="line">redis-server –-service-install –-service-name redisService3 –-port 10003</span><br><span class="line">redis-server –-service-start –-service-name redisService3</span><br></pre></td></tr></table></figure>
<h2 id="Windows配置主从Redis"><a href="#Windows配置主从Redis" class="headerlink" title="Windows配置主从Redis"></a>Windows配置主从Redis</h2><p>先将Redis目录复制一份，命名为<strong>Redis-x64-3.2-Slave</strong>，并将原Redis目录命名为<strong>Redis-x64-3.2-Master</strong>，注释掉master目录redis.windows.conf文件的集群配置，或者将其设置为<strong>no</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># cluster-enabled yes</span><br><span class="line"># 或者设置为no</span><br><span class="line">cluster-enabled no</span><br></pre></td></tr></table></figure>
<p>修改slave目录redis.windows.conf的端口号为6380，同样注释掉集群配置或设置为<strong>no</strong>，在slaveof后面添加master机器的IP和端口号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">port 6380</span><br><span class="line">slaveof 127.0.0.1 6379</span><br><span class="line"># cluster-enabled yes</span><br><span class="line"># 或者设置为no</span><br><span class="line">cluster-enabled no</span><br></pre></td></tr></table></figure>
<p>然后先启动Master，之后再启动Slave机器，输出如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2-Master&gt;redis-server redis.windows.conf</span><br><span class="line">[20048] 26 Dec 13:04:49.064 * Node configuration loaded, I&apos;m f1c7db8c98b01e9fbd5</span><br><span class="line">089b1231ca0e2d23a1766</span><br><span class="line">                _._</span><br><span class="line">           _.-``__ &apos;&apos;-._</span><br><span class="line">      _.-``    `.  `_.  &apos;&apos;-._           Redis 3.2.100 (00000000/0) 64 bit</span><br><span class="line">  .-`` .-```.  ```\/    _.,_ &apos;&apos;-._</span><br><span class="line"> (    &apos;      ,       .-`  | `,    )     Running in cluster mode</span><br><span class="line"> |`-._`-...-` __...-.``-._|&apos;` _.-&apos;|     Port: 6379</span><br><span class="line"> |    `-._   `._    /     _.-&apos;    |     PID: 20048</span><br><span class="line">  `-._    `-._  `-./  _.-&apos;    _.-&apos;</span><br><span class="line"> |`-._`-._    `-.__.-&apos;    _.-&apos;_.-&apos;|</span><br><span class="line"> |    `-._`-._        _.-&apos;_.-&apos;    |           http://redis.io</span><br><span class="line">  `-._    `-._`-.__.-&apos;_.-&apos;    _.-&apos;</span><br><span class="line"> |`-._`-._    `-.__.-&apos;    _.-&apos;_.-&apos;|</span><br><span class="line"> |    `-._`-._        _.-&apos;_.-&apos;    |</span><br><span class="line">  `-._    `-._`-.__.-&apos;_.-&apos;    _.-&apos;</span><br><span class="line">      `-._    `-.__.-&apos;    _.-&apos;</span><br><span class="line">          `-._        _.-&apos;</span><br><span class="line">              `-.__.-&apos;</span><br><span class="line">[20048] 26 Dec 13:04:49.066 # Server started, Redis version 3.2.100</span><br><span class="line">[20048] 26 Dec 13:04:49.067 * DB loaded from disk: 0.000 seconds</span><br><span class="line">[20048] 26 Dec 13:04:49.067 * The server is now ready to accept connections on p</span><br><span class="line">ort 6379</span><br><span class="line">[20048] 26 Dec 13:05:14.723 * Slave 127.0.0.1:6380 asks for synchronization</span><br><span class="line">[20048] 26 Dec 13:05:14.723 * Full resync requested by slave 127.0.0.1:6380</span><br><span class="line">[20048] 26 Dec 13:05:14.724 * Starting BGSAVE for SYNC with target: disk</span><br><span class="line">[20048] 26 Dec 13:05:14.726 * Background saving started by pid 26568</span><br><span class="line">[20048] 26 Dec 13:05:14.867 # fork operation complete</span><br><span class="line">[20048] 26 Dec 13:05:14.867 * Background saving terminated with success</span><br><span class="line">[20048] 26 Dec 13:05:14.869 * Synchronization with slave 127.0.0.1:6380 succeeded</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2-Slave&gt;redis-server redis.windows.conf</span><br><span class="line">                _._</span><br><span class="line">           _.-``__ &apos;&apos;-._</span><br><span class="line">      _.-``    `.  `_.  &apos;&apos;-._           Redis 3.2.100 (00000000/0) 64 bit</span><br><span class="line">  .-`` .-```.  ```\/    _.,_ &apos;&apos;-._</span><br><span class="line"> (    &apos;      ,       .-`  | `,    )     Running in standalone mode</span><br><span class="line"> |`-._`-...-` __...-.``-._|&apos;` _.-&apos;|     Port: 6380</span><br><span class="line"> |    `-._   `._    /     _.-&apos;    |     PID: 21036</span><br><span class="line">  `-._    `-._  `-./  _.-&apos;    _.-&apos;</span><br><span class="line"> |`-._`-._    `-.__.-&apos;    _.-&apos;_.-&apos;|</span><br><span class="line"> |    `-._`-._        _.-&apos;_.-&apos;    |           http://redis.io</span><br><span class="line">  `-._    `-._`-.__.-&apos;_.-&apos;    _.-&apos;</span><br><span class="line"> |`-._`-._    `-.__.-&apos;    _.-&apos;_.-&apos;|</span><br><span class="line"> |    `-._`-._        _.-&apos;_.-&apos;    |</span><br><span class="line">  `-._    `-._`-.__.-&apos;_.-&apos;    _.-&apos;</span><br><span class="line">      `-._    `-.__.-&apos;    _.-&apos;</span><br><span class="line">          `-._        _.-&apos;</span><br><span class="line">              `-.__.-&apos;</span><br><span class="line">[21036] 26 Dec 13:05:14.720 # Server started, Redis version 3.2.100</span><br><span class="line">[21036] 26 Dec 13:05:14.721 * DB loaded from disk: 0.001 seconds</span><br><span class="line">[21036] 26 Dec 13:05:14.721 * The server is now ready to accept connections on p</span><br><span class="line">ort 6380</span><br><span class="line">[21036] 26 Dec 13:05:14.721 * Connecting to MASTER 127.0.0.1:6379</span><br><span class="line">[21036] 26 Dec 13:05:14.722 * MASTER &lt;-&gt; SLAVE sync started</span><br><span class="line">[21036] 26 Dec 13:05:14.722 * Non blocking connect for SYNC fired the event.</span><br><span class="line">[21036] 26 Dec 13:05:14.722 * Master replied to PING, replication can continue..</span><br><span class="line">.</span><br><span class="line">[21036] 26 Dec 13:05:14.722 * Partial resynchronization not possible (no cached</span><br><span class="line">master)</span><br><span class="line">[21036] 26 Dec 13:05:14.726 * Full resync from master: a326a4da325133537c655c16b</span><br><span class="line">3a6c2546620f816:1</span><br><span class="line">[21036] 26 Dec 13:05:14.868 * MASTER &lt;-&gt; SLAVE sync: receiving 75 bytes from mas</span><br><span class="line">ter</span><br><span class="line">[21036] 26 Dec 13:05:14.871 * MASTER &lt;-&gt; SLAVE sync: Flushing old data</span><br><span class="line">[21036] 26 Dec 13:05:14.871 * MASTER &lt;-&gt; SLAVE sync: Loading DB in memory</span><br><span class="line">[21036] 26 Dec 13:05:14.872 * MASTER &lt;-&gt; SLAVE sync: Finished with success</span><br></pre></td></tr></table></figure>
<p>如果在配置中不小心启用了<strong>cluster-enabled yes</strong>的话，会抛<strong>slaveof directive not allowed in cluster mode</strong>和<strong>(error) CLUSTERDOWN Hash slot not served</strong>异常。</p>
<h3 id="主从测试"><a href="#主从测试" class="headerlink" title="主从测试"></a>主从测试</h3><p>在主机中使用set，添加一个key之后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2-Master&gt;redis-cli</span><br><span class="line">127.0.0.1:6379&gt; set “mm” “mm in master”</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<p>在从机中使用get，得到这个key的value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2-Slave&gt;redis-cli</span><br><span class="line">127.0.0.1:6379&gt; get “mm”</span><br><span class="line">“mm in master”</span><br></pre></td></tr></table></figure>
<p>反过来，在从机使用set之后也可以同步到master</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2-Slave&gt;redis-cli</span><br><span class="line">127.0.0.1:6379&gt; set “kk” “mm in slave”</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<p>在主机get得到value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">D:\Redis-x64-3.2-Master&gt;redis-cli</span><br><span class="line">127.0.0.1:6379&gt; get “kk”</span><br><span class="line">“mm in slave”</span><br></pre></td></tr></table></figure>
<p>注意，redis的主从配置和集群配置方法是不同的，从机一般是只读的，主机用来进行写操作，一个主数据库可以有多个从数据库，而一个从数据库只能有一个主数据库。一般redis的持久化策略是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">save 900 1 #当有一条Keys数据被改变时，900秒刷新到Disk一次</span><br><span class="line">save 300 10 #当有10条Keys数据被改变时，300秒刷新到Disk一次</span><br><span class="line">save 60 10000 #当有10000条Keys数据被改变时，60秒刷新到Disk一次</span><br></pre></td></tr></table></figure>
<p>Redis的主从复制是建立在内存快照的持久化基础上的，只要有Slave就一定会有内存快照发生。可以很明显的看到，RDB有它的不足，就是一旦数据库出现问题，那么我们的RDB文件中保存的数据并不是全新的。从上次RDB文件生成到Redis停机这段时间的数据全部丢掉了。</p>
<p>AOF(Append-Only File)比RDB方式有更好的持久化性。由于在使用AOF持久化方式时，Redis会将每一个收到的写命令都通过Write函数追加到文件中，类似于MySQL的binlog。当Redis重启是会通过重新执行文件中保存的写命令来在内存中重建整个数据库的内容。对应的设置参数为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">appendonly yes #启用AOF持久化方式</span><br><span class="line">appendfilename appendonly.aof #AOF文件的名称，默认为appendonly.aof</span><br><span class="line">appendfsync always #每次收到写命令就立即强制写入磁盘，是最有保证的完全的持久化，但速度也是最慢的，一般不推荐使用。</span><br><span class="line">appendfsync everysec #每秒钟强制写入磁盘一次，在性能和持久化方面做了很好的折中，是受推荐的方式。</span><br><span class="line">appendfsync no #完全依赖OS的写入，一般为30秒左右一次，性能最好但是持久化最没有保证，不被推荐。</span><br></pre></td></tr></table></figure>
<p>AOF的完全持久化方式同时也带来了另一个问题，持久化文件会变得越来越大。比如我们调用INCR test命令100次，文件中就必须保存全部的100条命令，但其实99条都是多余的。因为要恢复数据库的状态其实文件中保存一条SET test 100就够了。为了压缩AOF的持久化文件，Redis提供了bgrewriteaof命令。收到此命令后Redis将使用与快照类似的方式将内存中的数据以命令的方式保存到临时文件中，最后替换原来的文件，以此来实现控制AOF文件的增长。由于是模拟快照的过程，因此在重写AOF文件时并没有读取旧的AOF文件，而是将整个内存中的数据库内容用命令的方式重写了一个新的AOF文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">no-appendfsync-on-rewrite yes #在日志重写时，不进行命令追加操作，而只是将其放在缓冲区里，避免与命令的追加造成DISK IO上的冲突。</span><br><span class="line">auto-aof-rewrite-percentage 100 #当前AOF文件大小是上次日志重写得到AOF文件大小的二倍时，自动启动新的日志重写过程。</span><br><span class="line">auto-aof-rewrite-min-size 64mb #当前AOF文件启动新的日志重写过程的最小值，避免刚刚启动Reids时由于文件尺寸较小导致频繁的重写。</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>参考文献</strong><br><a href="http://codepub.cn/2016/11/19/Windows-installs-the-redis-service/" target="_blank" rel="noopener">原文链接</a><br><a href="http://doc.redisfans.com/" target="_blank" rel="noopener">Redis 命令参考</a><br>[1] <a href="http://blog.csdn.net/renfufei/article/details/38474435/" target="_blank" rel="noopener">http://blog.csdn.net/renfufei/article/details/38474435/</a><br>[2] <a href="http://blog.chinaunix.net/uid-20682890-id-3603246.html" target="_blank" rel="noopener">http://blog.chinaunix.net/uid-20682890-id-3603246.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/Programming-Thinking/2018/03/Resource-Based-Access-Control.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Programming-Thinking/2018/03/Resource-Based-Access-Control.html" itemprop="url">编程思想：角色权限管理策略(RBAC 新解)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-17T22:11:31+08:00">
                2018-03-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming-Thinking/" itemprop="url" rel="index">
                    <span itemprop="name">Programming Thinking</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>本文讨论以角色概念进行的权限管理策略及主要以基于角色的机制进行权限管理是远远不够的。
同时讨论一种我认为更好的权限管理方式
</code></pre><h2 id="什么是角色"><a href="#什么是角色" class="headerlink" title="什么是角色"></a>什么是角色</h2><pre><code>角色：一系列可执行的操作或责任的实体(用于限定你在软件系统中能做什么、不能做什么。用户帐号往往与角色相关联)
</code></pre><p>例如，一个用户以关联了”项目管理员”角色的帐号登录系统，那这个用户就可以做项目管理员能做的所有事情</p>
<p>从这个意义上来说，角色更多的是一种行为的概念：它表示用户能在系统中进行的操作</p>
<h2 id="基于角色的访问控制（Role-Based-Access-Control）"><a href="#基于角色的访问控制（Role-Based-Access-Control）" class="headerlink" title="基于角色的访问控制（Role-Based Access Control）"></a>基于角色的访问控制（Role-Based Access Control）</h2><pre><code>基于角色的访问控制(Role-Based Access Control)：在软件开发中使用角色来控制对软件功能和数据的访问，简称RBAC
</code></pre><p>有两种正使用的RBAC控制方式：<code>隐式(模糊)的方式</code>和<code>显示(明确)的方式</code></p>
<h3 id="隐式的访问控制"><a href="#隐式的访问控制" class="headerlink" title="隐式的访问控制"></a>隐式的访问控制</h3><pre><code>不能明确的知道一个角色到底关联了哪些可执行操作，直接通过角色来验证用户有没有操作权限
</code></pre><p>例如：“项目管理员”角色能查看项目报表<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过验证用户角色来判断操作权限</span></span><br><span class="line"><span class="keyword">if</span> (user.hasRole(<span class="string">"Project Manager"</span>) ) &#123;</span><br><span class="line">    <span class="comment">//show project reports</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//don't show project reports</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面代码通过判断用户是否有”项目管理员”角色来决定是否显示查看项目报表，并没有明确语句来定义”项目管理员”这一角色到底包含哪些可执行的行为</p>
<h4 id="脆弱的权限策略"><a href="#脆弱的权限策略" class="headerlink" title="脆弱的权限策略"></a>脆弱的权限策略</h4><pre><code>上面这种权限访问控制是非常脆弱的，一个极小的权限方面的需求变动都可能导致上面的代码需要重新修改
</code></pre><p>假如：需要新增“部门管理员”角色，也能查看项目报表<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (user.hasRole(<span class="string">"Project Manager"</span>) || user.hasRole(<span class="string">"Department Manager"</span>) ) &#123;</span><br><span class="line">    <span class="comment">//show project reports</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//don't show project reports</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>任何微小的权限需求的变动都可能需要修改软件功能和数据访问的代码</p>
<h3 id="显示的访问控制-更好的选择"><a href="#显示的访问控制-更好的选择" class="headerlink" title="显示的访问控制(更好的选择)"></a>显示的访问控制(更好的选择)</h3><pre><code>明确定义一个角色能对哪些资源进行什么操作
</code></pre><p>例如：如果当前用户允许查看编号为12345的项目报表，则显示项目报表按钮(不要太在意冒号分隔的语法，这仅是一个例子)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过验证操作权限判断角色能否操作</span></span><br><span class="line"><span class="keyword">if</span> (user.isPermitted(<span class="string">"projectReport:view:12345"</span>)) &#123;</span><br><span class="line">    <span class="comment">//show the project report button</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//don't show the button</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="显式的权限控制方式的好处"><a href="#显式的权限控制方式的好处" class="headerlink" title="显式的权限控制方式的好处"></a>显式的权限控制方式的好处</h4><ul>
<li>更少的代码重构<ul>
<li>系统的功能需求一旦确定下来后，一段时间内对它的改动相应还是比较少的。</li>
<li>显式的权限控制方式不会因不同的角色要对功能进行操作而修改功能代码</li>
</ul>
</li>
<li>更直观<ul>
<li>保护资源对象、控制对资源对象的操作。</li>
<li>这样的权限控制方式更符合人们的思想习惯。</li>
</ul>
</li>
<li>更有弹性<ul>
<li>可支持任何安全模型的设计</li>
<li>例如：将操作(权限)直接分配给角色，或者将多个角色关联到组(group)上</li>
</ul>
</li>
<li>外部安全策略管理<ul>
<li>资源/行为与用户、组、角色的关联可以通过外部的模块或专用工具或管理控制台来完成</li>
</ul>
</li>
<li>可在运行环境做修改<ul>
<li>因为基于资源的权限控制代码并不依赖于行为的主体(如组、角色、用户等)（没有将行为的主体的字符名词写在代码中），所以你甚至可以在程序运行的时候通过修改主体能对资源进行的操作，通过配置的方式就可应对权限方面需求的变动，不需要重构代码</li>
</ul>
</li>
</ul>
<h2 id="RBAC新解：Resource-Based-Access-Control"><a href="#RBAC新解：Resource-Based-Access-Control" class="headerlink" title="RBAC新解：Resource-Based Access Control"></a>RBAC新解：Resource-Based Access Control</h2><pre><code>这种显式的机制带给我们的富有弹性的权限模型。在这种新的模型下，已不必再局限于角色了，
你可以将权限直接分配给用户、组或其它对象
</code></pre><p>因为显式地、基于资源的权限访问控制的诸多好处，或许可以给RBAC一个新的定义：“Resource-Based Access Control”。</p>
<h3 id="基于资源的权限访问控制举例：-Apache-Shiro"><a href="#基于资源的权限访问控制举例：-Apache-Shiro" class="headerlink" title="基于资源的权限访问控制举例： Apache Shiro"></a>基于资源的权限访问控制举例： Apache Shiro</h3><pre><code>Apache Shiro：一个java平台的现代权限管理框架，Shiro很好地支持基于资源的权限访问控制。
</code></pre><p><a href="http://globeeip.iteye.com/blog/1236167" target="_blank" rel="noopener">原文链接</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.yoursite.com/Interview/2018/03/cjl6f9v6x001bsoq6m5wijtkb.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="liwenfeng">
      <meta itemprop="description" content="将来的你，一定会感谢此刻的自己……">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="愤怒的IT青年">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Interview/2018/03/cjl6f9v6x001bsoq6m5wijtkb.html" itemprop="url">面试--java后端 2018.03.15</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-16T16:56:34+08:00">
                2018-03-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Interview/" itemprop="url" rel="index">
                    <span itemprop="name">Interview</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><h3 id="Java-基础"><a href="#Java-基础" class="headerlink" title="Java 基础"></a>Java 基础</h3><h4 id="Java-中基础类型"><a href="#Java-中基础类型" class="headerlink" title="Java 中基础类型"></a>Java 中基础类型</h4><pre><code>Java中8大基础类型：byte、shot、int、long、float、double、char、boolean

重点:String是引用类型
</code></pre><h4 id="Java-中基础类型的包装类什么，它们之间有什么区别"><a href="#Java-中基础类型的包装类什么，它们之间有什么区别" class="headerlink" title="Java 中基础类型的包装类什么，它们之间有什么区别"></a>Java 中基础类型的包装类什么，它们之间有什么区别</h4><table>
<thead>
<tr>
<th style="text-align:center">基础类型</th>
<th style="text-align:center">包装类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">byte</td>
<td style="text-align:center">Byte</td>
</tr>
<tr>
<td style="text-align:center">shot</td>
<td style="text-align:center">Short</td>
</tr>
<tr>
<td style="text-align:center">int</td>
<td style="text-align:center">Integer</td>
</tr>
<tr>
<td style="text-align:center">long</td>
<td style="text-align:center">Long</td>
</tr>
<tr>
<td style="text-align:center">float</td>
<td style="text-align:center">Float</td>
</tr>
<tr>
<td style="text-align:center">double</td>
<td style="text-align:center">Double</td>
</tr>
<tr>
<td style="text-align:center">char</td>
<td style="text-align:center">Character</td>
</tr>
<tr>
<td style="text-align:center">boolean</td>
<td style="text-align:center">Boolean</td>
</tr>
</tbody>
</table>
<p>基础类型的包装类的区别:</p>
<ul>
<li>包装类型是对象，基本类型不是</li>
<li>传递类型： 包装类型型是引用传递，基本类型是值传递</li>
<li>声明方式：包装类型需要new在堆内存中进行new来分配内存空间 ，数据类型不需要new关键字</li>
<li>存储位置：包装类型是把对象放在堆中，基本数据类型直接将值保存在值栈中</li>
<li>值：包装类型值可以为null，基础类型不能为null</li>
<li>初始值：包装类型的初始值为null，基础类型各类型初始值不同</li>
</ul>
<h4 id="Object类中有哪些方法"><a href="#Object类中有哪些方法" class="headerlink" title="Object类中有哪些方法"></a>Object类中有哪些方法</h4><pre><code>Object类中的方法：getClass()、hashCode()、equals(Object obj)、clone()、toString()、notify()、notifyAll()、wait()、finalize()……
</code></pre><h4 id="为什么要重写equal-和-hashCode-方法"><a href="#为什么要重写equal-和-hashCode-方法" class="headerlink" title="为什么要重写equal() 和 hashCode() 方法"></a>为什么要重写equal() 和 hashCode() 方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在Object类中:</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>; </span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">	    <span class="keyword">return</span> (<span class="keyword">this</span> == obj);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>Object 类中的equal() 方法和hashCode() 方法</strong><br> equal() 方法：判断的是两个对象的内存地址<br> hashCode() 方法：返回的是对象的内存地址</p>
</li>
<li><p><strong>equal() 和hashCode() 的关系</strong><br> equal() 返回true，则两个对象的hashCode() 的值必须是一样的<br> <del><em>JDK原文：如果根据 equals(Object) 方法，两个对象是相等的，那么对这两个对象中的每个对象调用 hashCode 方法都必须生成相同的整数结果</em></del><br> equal() 返回false，两个对象的hashCode() 的值不一定不一样，但不相等的对象生成不同hashCode() 值可以提高哈希表的性能<br> <del><em>JDK原文：如果根据 equals(java.lang.Object) 方法，两个对象不相等，那么对这两个对象中的任一对象上调用 hashCode 方法不 要求一定生成不同的整数结果。但是，程序员应该意识到，为不相等的对象生成不同整数结果可以提高哈希表的性能</em></del></p>
</li>
<li><p><strong>为什么要重写equal() 方法</strong><br> Object类中equals()判断的是两个对象的内存地址<br> 有时我们希望两个对象只要是某些属性相同就认为他们的quals() 为true，此时就应该修改equal() 方法</p>
</li>
<li><p><strong>为什么要重写hashCode() 方法 </strong><br> 如果重写equal() 方法，两个对象属性相等且返回true，此时两个对象的内存地址不同，如果不重写hashcode()，hashCode 必然不相等<br> 由于equal() 方法返回true，hashCode() 的值必须是一样的，所以有必要重写hashCode() 方法</p>
</li>
<li><p><strong>不重写hashCode() 方法可能产生的后果</strong></p>
<p> 只重写equal() 方法，不重写hashCode() 方法，在HashSet中添加两个equals() 为true的对象时，可能会将两个对象都加入进去</p>
</li>
</ul>
<p><a href="http://blog.csdn.net/u013679744/article/details/57074669" target="_blank" rel="noopener">参考链接</a></p>
<h4 id="集合中HashSet-和HashMap-有什么区别"><a href="#集合中HashSet-和HashMap-有什么区别" class="headerlink" title="集合中HashSet 和HashMap 有什么区别"></a>集合中HashSet 和HashMap 有什么区别</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//HashSet类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Set</span>&lt;<span class="title">E</span>&gt;, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//HashMap类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt;, <span class="title">Cloneable</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">HashMap</th>
<th style="text-align:center">HashSet</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">实现了Map接口</td>
<td style="text-align:center">实现Set接口</td>
</tr>
<tr>
<td style="text-align:center">存储键值对</td>
<td style="text-align:center">仅存储对象</td>
</tr>
<tr>
<td style="text-align:center">调用put() 向map中添加元素</td>
<td style="text-align:center">调用add() 方法向Set中添加元素</td>
</tr>
<tr>
<td style="text-align:center">HashMap使用键(Key)计算Hashcode</td>
<td style="text-align:center">HashSet 使用成员对象来计算hashcode 值，对于两个对象来说hashcode 可能相同，所以equals() 方法用来判断对象的相等性，如果两个对象不同的话，那么返回false</td>
</tr>
<tr>
<td style="text-align:center">HashMap 相对于HashSet 较快，因为它是使用唯一的键获取对象</td>
<td style="text-align:center">HashSet 较HashMap 来说比较慢</td>
</tr>
</tbody>
</table>
<p><a href="http://www.importnew.com/6931.html" target="_blank" rel="noopener">参考链接</a></p>
<h4 id="原始的JDBC连接数据库有哪几个步骤"><a href="#原始的JDBC连接数据库有哪几个步骤" class="headerlink" title="原始的JDBC连接数据库有哪几个步骤"></a>原始的JDBC连接数据库有哪几个步骤</h4><ul>
<li><p>七个步骤：</p>
<ul>
<li><p>加载数据库驱动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、加载数据库驱动（ 成功加载后，会将Driver类的实例注册到DriverManager类中）</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取数据库连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、获取数据库连接</span></span><br><span class="line">conn = DriverManager.getConnection(<span class="string">"jdbc:mysql://127.0.0.1:3306/jdbctest"</span>, username, password);</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取数据库操作对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3、获取数据库操作对象</span></span><br><span class="line">stmt = conn.createStatement();</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义操作的SQL语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4、定义操作的SQL语句  </span></span><br><span class="line">String sql = <span class="string">"select * from user"</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行数据库操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 5、执行数据库操作  </span></span><br><span class="line">ResultSet rs = stmt.executeQuery(sql);</span><br></pre></td></tr></table></figure>
</li>
<li><p>处理结果集</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 6、获取并操作结果集  </span></span><br><span class="line"><span class="keyword">while</span> (rs.next()) &#123;  </span><br><span class="line">    System.out.println(rs.getInt(<span class="string">"id"</span>));  </span><br><span class="line">    System.out.println(rs.getString(<span class="string">"name"</span>));  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭对象，回收数据库资源(关闭结果集–&gt;关闭数据库操作对象–&gt;关闭连接)</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 6、关闭对象</span></span><br><span class="line"><span class="comment">//关闭结果集对象  </span></span><br><span class="line">rs.close();</span><br><span class="line"><span class="comment">//关闭数据库操作对象  </span></span><br><span class="line">stmt.close();</span><br><span class="line"><span class="comment">//关闭数据库连接对象 </span></span><br><span class="line">conn.close();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="后端框架"><a href="#后端框架" class="headerlink" title="后端框架"></a>后端框架</h3><h4 id="Hibernate-有哪几种状态"><a href="#Hibernate-有哪几种状态" class="headerlink" title="Hibernate 有哪几种状态"></a>Hibernate 有哪几种状态</h4><p>​        临时状态、持久化状态、游离态</p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><h5 id="索引一般建在哪"><a href="#索引一般建在哪" class="headerlink" title="索引一般建在哪"></a>索引一般建在哪</h5><h3 id="Html"><a href="#Html" class="headerlink" title="Html"></a>Html</h3><h4 id="lt-div-gt-是什么元素"><a href="#lt-div-gt-是什么元素" class="headerlink" title="&lt;div&gt;是什么元素"></a><code>&lt;div&gt;</code>是什么元素</h4><h4 id="让两个-lt-div-gt-并行有哪几种方法"><a href="#让两个-lt-div-gt-并行有哪几种方法" class="headerlink" title="让两个&lt;div&gt;并行有哪几种方法"></a>让两个<code>&lt;div&gt;</code>并行有哪几种方法</h4><h3 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h3><h4 id="javascript-和Jquery有什么区别"><a href="#javascript-和Jquery有什么区别" class="headerlink" title="javascript 和Jquery有什么区别"></a>javascript 和Jquery有什么区别</h4><h3 id="C语言"><a href="#C语言" class="headerlink" title="C语言"></a>C语言</h3><h4 id="指针是什么"><a href="#指针是什么" class="headerlink" title="指针是什么"></a>指针是什么</h4>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="liwenfeng" />
            
              <p class="site-author-name" itemprop="name">liwenfeng</p>
			  <!--liwenfeng:change 2018.03.18 begin-->
              <p class="site-description motion-element" itemprop="description"></p>
			  <p class="site-description motion-element" itemprop="description">人若有才，清风自来</p>
			  <!--liwenfeng:change 2018.03.18 end-->
			  <p class="site-description motion-element" itemprop="description"></p>

          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright" align="center">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liwenfeng</span>

  
</div>



<div align="center">
<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数：<span id="busuanzi_value_site_pv"></span>
</span>
</div>


  <span class="post-meta-divider">|</span>


  <div class="powered-by">个人专属</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">博客 &mdash; <a class="theme-link" target="_blank" href="../">leewf</a></div>

</div>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
